Downloaded 01/17/23 to 202.38.84.171. Redistribution subject to SEG license or copyright; see Terms of Use at http://library.seg.org/page/policies/terms
DOI:10.1190/geo2022-0159.1

GEOPHYSICS, VOL. 88, NO. 1 (JANUARY-FEBRUARY 2023); P. WA105–WA114, 10 FIGS., 3 TABLES.
10.1190/GEO2022-0159.1

Enhancing one-way wave equation-based migration with deep learning

Yuwei Yu1, Yaxing Li1, Xinming Wu1, and Xiaofeng Jia1

ABSTRACT
One advantage of one-way wave equation-based migration is
its low computational cost. However, due to the limited wavefield
propagation angle, it is difficult to use one-way wave equationbased migration for high-precision imaging of structures with
large inclinations due to issues such as inaccurate amplitudes
and migration image artifacts. In addition, when the model has
large horizontal velocity differences, it is difficult for the oneway wave propagator to calculate an accurate wavefield phase.
Reverse time migration (RTM) based on the two-way wave
propagator has a high resolution and avoids the issues associated
with one-way wave propagators; however, it has a high computational cost in practical applications. We develop a convolutional
neural network (CNN) application mode that improves one

INTRODUCTION
Seismic migration is a detection technique that returns the energy
of recorded data to its original position. The returned energy creates
an image that outlines underground structures; these migration images can be used for resource exploration and disaster prevention.
After years of research, various migration methods (Shragge and
Shan, 2008; Etgen et al., 2009; Leveille et al., 2011) have been proposed in response to different detection requirements. Among them,
reverse time migration (RTM) based on the two-way wave propagation operator (Baysal et al., 1983; McMechan, 1983) is preferred
by researchers because of its outstanding imaging performance.
However, in prestack RTM, the zero-lag crosscorrelation between
the two-way source wavefield and the two-way receiver wavefield
produces artifacts, many of which have low-frequency features.
Many methods for addressing this problem have been proposed
(Leveille et al., 2011). The Laplacian operator (Youn and Zhou,

migration method by learning from another one and design a
CNN with a structure similar to U-net that combines the advantages of both migration methods. The CNN label is the RTM result, and the corresponding input is the result of one-way wave
migration with a generalized screen propagator (GSP). The
trained CNN model improves the amplitude in the one-way wave
migration image and removes the errors caused by large lateral
velocity perturbations. Moreover, by maintaining the high migration calculation efficiency, our CNN model allows for a high resolution, few artifacts, and accurate images of steep structures in
the one-way wave migration result. With our method, the accuracy of the one-way wave migration result is close to that of the
RTM result. The use of GSP-based migration in our CNN model
rather than conventional RTM to generate prospecting images can
considerably reduce the calculation costs.

2001; Zhang and Sun, 2009) can be used to process RTM images,
effectively attenuating low-frequency artifacts. Mulder and Plessix
(2003, 2004) use a high-pass filter to address low-frequency artifacts. Fletcher et al. (2005, 2006) introduce sponge boundary conditions in the nonreflection wave equation to attenuate reflected
waves, thereby reducing the artifacts in RTM images. Yoon and
Marfurt (2006) propose a new imaging condition with propagation
angle constraints using the Poynting vector, which eliminated false
imaging at nonreflecting points. Guitton et al. (2007) propose a
least-squares filtering method that removes low-frequency artifacts
while maintaining accurate imaging results. Liu et al. (2007, 2011)
apply various techniques, such as the Hilbert transform, to replace
the crosscorrelation of the two-way wavefields with the directed
crosscorrelation of the one-way wavefields, which prevents the generation of artifacts in the RTM process. Based on the previous research, Fei et al. (2015) propose a de-primary imaging condition
with fewer wavefield components to address these artifacts. Rocha

Manuscript received by the Editor 17 March 2022; revised manuscript received 20 July 2022; published ahead of production 12 September 2022; published
online 28 October 2022.
1
University of Science and Technology of China, School of Earth and Space Sciences, Laboratory of Seismology and Physics of Earth’s Interior, Hefei, China
and University of Science and Technology of China, National Geophysical Observatory at Mengcheng, Hefei, China. E-mail: yuyuwei@mail.ustc.edu.cn;
yxli2017@mail.ustc.edu.cn; xinmwu@ustc.edu.cn; xjia@ustc.edu.cn (corresponding author).
© 2023 Society of Exploration Geophysicists. All rights reserved.
WA105

Downloaded 01/17/23 to 202.38.84.171. Redistribution subject to SEG license or copyright; see Terms of Use at http://library.seg.org/page/policies/terms
DOI:10.1190/geo2022-0159.1

WA106

Yu et al.

et al. (2016) propose a new inner product technique for RTM and
full-waveform inversion (FWI), which can attenuate reflection in
any ideal direction to remove RTM artifacts.
At present, the aforementioned methods for removing the RTM
artifacts satisfy different detection requirements. The main impediment to the widespread adoption of regular RTM is the high computational cost (Etgen et al., 2009; Zhang and Sun, 2009; Leveille et al.,
2011). It takes a considerable amount of time to calculate the twoway wavefields, and the extensive writing and reading operations require a large amount of storage space. Some methods for removing
the artifacts (Fletcher et al., 2005, 2006; Yoon and Marfurt, 2006;
Guitton et al., 2007; Liu et al., 2007, 2011; Fei et al., 2015; Rocha
et al., 2016) also require substantial computational costs. Griewank
(1992) proposes a checkpointing algorithm for reducing the storage
required by writing and reading operations, and the few stored checkpoint wavefields could be used to reconstruct any wavefield.
Griewank and Walther (2000) develop an optimized checkpointing
method that greatly reduces the memory requirements while slightly
increasing the computational load. Symes (2007) introduces this optimal checkpointing technology (Griewank and Walther, 2000) into
RTM, which reduces the reliance of RTM on disk input/output. Anderson et al. (2012) present a modified version of the optimal checkpointing technology (Griewank and Walther, 2000) for isotropic
elastic RTM and anisotropic viscoelastic FWI. For wavefield
reconstruction in attenuated media, Yang et al. (2016) propose a
checkpointing-assisted technique that requires less wavefield information than the optimal checkpointing technique. Although these
methods can address the issue of limited computer memory, the large
computational load of RTM remains a challenge. To reduce the computational cost, Morton and Ober (1998), Jing et al. (2000), and Zhao
et al. (2016) propose methods for loading multiple pairs of seismic
sources and recording data simultaneously in one migration. Due to
the mismatch between the shot and the shot gather, the migration
image often includes noise and crosstalk artifacts. Perrone and Sava
(2012) propose a hybrid encoding method that combined the advantages of random shot-encoding migration and plane-wave migration.
Their method maintains the resolution of traditional RTM while
reducing noise in the images. Jia et al. (2020) develop a supervirtual
shot-encoding scheme to attenuate artifacts in the simultaneous migration of multishot-gather data. This method has higher computational efficiency than plane-wave encoding methods.
Solving the wavefield in only one direction (Claerbout, 1970;
Stoffa et al., 1990; Ristow and Rühl, 1994) can significantly reduce
the calculation time. However, the limited wavefield propagation
angle of the one-way wave propagator introduces large migration errors. Ristow and Rühl (1994) propose a hybrid migration method that
combines phase-shift migration and finite-difference schemes; this
method can be applied with relatively large velocity variations and
steeply inclined structures. To expand the propagation angle of
one-way elastic waves in arbitrarily heterogeneous media, Wu (1994)
develops a thin-slab formulation of one-way elastic wave equations. Grimbergen et al. (1998) propose a modal expansion method
to construct an intrinsically stable one-way wave propagator, which
can improve the lateral resolution of migration. Xie and Wu (1998)
use the Padé approximation to deal with the one-way wave equation
and propose a new screen method. The proposed generalized screen
propagator (GSP) simulates the wavefield relatively accurately with
high velocity contrast and has a larger propagation angle than the
previous screen propagator. Huang et al. (1999) propose an extended

Born Fourier migration to address the instability of the application
caused by the singularity problem and to accurately handle the steep
interface problem. Zhang and Yao (2011) propose a compensation
scheme with high computational efficiency to reduce the numerical
dispersion and two-way splitting error of the finite-difference
method. Based on the Chebyshev polynomials, Zhang et al. (2010)
and Song et al. (2022) develop new Fourier propagators with propagation angles greater than 60° within 1% phase error. Sandberg and
Beylkin (2009) use spectral projectors to remove the evanescent
waves in full-wave equation extrapolation, and their method preserves wave propagations at all angles. You et al. (2020) use the
derivative of the one-way wavefield to depth to realize the full-wave
equation depth migration. Jia and Wu (2009) develop a super-wide
angle one-way wave propagator to simulate turning waves. The migration based on their propagator could image overhanging structures. However, although one-way wave migration has been fully
developed, it still faces various problems (Etgen et al., 2009; Zhang
and Sun, 2009; Leveille et al., 2011): amplitude and phase inaccuracy, low resolution, and difficulty imaging large angle interfaces.
Deep learning is an artificial intelligence technology in computer
science that can identify data features and potentially replace humans
to complete tasks efficiently (Ronneberger et al., 2015; Sun et al.,
2017; Shi et al., 2019; Wu et al., 2020). In addition, deep learning
can be effective for problems that people cannot easily solve (Richardson and Feller, 2019; Yi and Bui, 2020; Avila et al., 2021; Zhang et al.,
2021). As deep learning has developed, it has become widely used in
various fields. Ronneberger et al. (2015) use convolutional neural networks (CNNs) to segment images of biological cells, and the network
accurately delineates the cell boundaries. The U-shaped network
(U-net) structure designed has been widely used in other studies.
Sun et al. (2017) build a highly accurate deep learning model for plant
classification. Yi and Bui (2020) apply deep learning to predict traffic
congestion. In the field of geophysics, Richardson and Feller (2019)
use a U-net for seismic data denoising. Wu et al. (2020) use a CNN for
geologic interpretation and accurately identify fault locations. Zhang
et al. (2021) use a CNN for least-squares RTM to reduce computational costs. Avila et al. (2021) propose a migration deconvolution
method that fits the inverse operator with a U-net rather than calculating the inverse Hessian matrix. This method has a higher resolution
than the Hessian filter least-squares migration method. In addition,
deep learning has been successfully applied to inversion (Yang and
Ma, 2019; Li et al., 2020; Wang et al., 2021), sparse data imaging
(Huang and Nowack, 2020), and first-break picking (Yuan et al.,
2018). Due to its wide applicability and perfect performance, deep
learning has broad application prospects in the field of geophysics.
In this paper, we propose a CNN-based method for enhancing oneway wave equation-based migration images. Our network is a U-net
with residual neural networks (ResNets). We use the RTM result based
on the two-way wave propagator as the label of our network. The input
is the one-way wave equation-based migration result. The one-way
wave propagator is realized by a GSP. The GSP-based migration is
faster than RTM. We intend to use the trained network to compensate
for the image amplitude and phase defects of GSP-based migration.

THEORY
Two-way wave equation-based migration
Seismic vibration is an intuitive manifestation of seismic wave
propagation, and the propagation of underground seismic waves

Enhancing one-way wave migration

Downloaded 01/17/23 to 202.38.84.171. Redistribution subject to SEG license or copyright; see Terms of Use at http://library.seg.org/page/policies/terms
DOI:10.1190/geo2022-0159.1

can be expressed by wave equations. The 2D acoustic wave equation can be written as

8


>
< ∂uðx;z;tÞ þ ρv2 ðx; zÞ ∂sx ðx;z;tÞ þ ∂sz ðx;z;tÞ ¼ 0
∂t

∂x

∂z

>
: ρ ∂sðx;z;tÞ þ ▿uðx; z; tÞ ¼ 0

;

(1)

∂t

where uðx; z; tÞ and t are the acoustic wavefield and time, respectively; x and z are the spatial coordinates in the horizontal and vertical directions, respectively; ρ and vðx; zÞ represent the density and
acoustic velocity, respectively; the particle vibration velocity field
has the form sðx; z; tÞ ¼ ðsx ðx; z; tÞ; sz ðx; z; tÞÞ; and ▿ is the gradient operator. In this work, the derivatives with respect to time
and space in equation 1 are approximated by the Taylor series. The
time derivative has the second-order precision, whereas the spatial
derivative has the fourth-order precision. The final image is produced by applying the imaging condition to the finite-difference
simulated wavefields.
We use RTM to generate the label image of the CNN; the RTM
imaging condition is

Iðx; zÞ ¼

Z T
0

us ðx; z; tÞug ðx; z; T − tÞdt;

(2)

where Iðx; zÞ denotes the imaging result; dt refers to the time interval; us ðx; z; tÞ and ug ðx; z; T − tÞ represent the forward-propagation
wavefield of the source and the backward-propagation wavefield of
the recorded data, respectively; and T is the total time of the recorded
data. In this paper, we use the Laplacian filter (Youn and Zhou, 2001)
to suppress the low-frequency artifacts of RTM.

One-way wave equation-based migration
In the frequency domain, the 2D acoustic wave equation can be
expressed in the following form:




∂2
∂2 uðx; zÞ
2 2
þ
k
r
¼ 0;
uðx; zÞ þ
r
2
∂z2
∂x

WA107

Z
uðx; zÞ ¼

dkx pðz; kx Þeikx x ;

(6)

where kx represents the x-direction wavenumber and pðz; kx Þeikx x
refers to a part of the wavenumber-domain wavefield. According to
equations 5 and 6, we have





δv
k2x
 −dzkr A 2 pðz0 ;kx Þ;
pðz1 ;kx Þ¼exp i dzkz −dzkr
v
kr
(7)
where dz is the spatial distance between z1 and z0 ; A ¼ 0.5½ð1=rÞ
−1; r is obtained from the Fourier transform of r, where  is the
wavenumber-domain convolution; δv ¼ v − vr is the velocity perturbation; and kz is the z-direction wavenumber. The right side of equation 7 includes three parts: the first two parts represent the phase
screen solution and the third part is a modifier that allows the propagator to adapt to large velocity perturbations and wide propagation
angles. To increase the computational efficiency, equation 7 can be
converted to a dual-domain format (Xie and Wu, 1998):






A ∂2
−idzkr δv
−1
idzk
z
v
pðx;z1 Þ ¼ 1þidz
F e
pðx;z0 Þ ;
×F e
kr ∂x2
(8)
where F½: represents the Fourier transform and F−1 ½: represents the
inverse Fourier transform. The GSP proposed in equation 8 can be
used to simulate wavefields in media with strong local velocity perturbations. The GSP models wide-angle wavefields with relatively
high accuracy and therefore can be used for migration. However,
the GSP is a one-way wave propagator, and thus its accuracy for wavefield simulations is lower than that of the two-way wave propagator.
We use the zero-lag crosscorrelation imaging condition in the
frequency domain:

(3)

where kr ¼ ω=vr is the reference wavenumber; ω and vr are the
angular frequency and the reference velocity, respectively; and r ¼
vr =v is the refraction index. Allowing for only the one-way wavefield, we decompose equation 3 and obtain the one-way wave equation of the forward propagation as

∂uðx; zÞ
¼i
∂z

sﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
∂2
þ k2r r2 uðx; zÞ;
∂x2

(4)

where i is the imaginary unit. We use the first-order Padé approximation to approximate the square root term of equation 4, yielding
(Xie and Wu, 1998)

2
3
1 1 ∂2
2
2
2
∂uðx; zÞ
2 kr r ∂x
5uðx; zÞ:
¼ irkr 41 þ
2
∂z
1 þ 14 21 2 ∂ 2
kr r ∂x

According to Fourier transform,

(5)

Figure 1. The topology of U-net1. In each rectangular frame, the
horizontal annotation represents the number of channels and the
vertical annotation represents the ratio of the size of the current image to the size of the original image. Conv, convolution; BN, batch
normalization; ReLU, rectified linear unit activation function; MaxPool, max pooling; and cat, concatenation.

Yu et al.

WA108

I 0 ðx; zÞ ¼

X

ps ðx; z; ωÞp⋄g ðx; z; ωÞ;

P1 ¼ I 1 þ α;

(9)

(10)

Downloaded 01/17/23 to 202.38.84.171. Redistribution subject to SEG license or copyright; see Terms of Use at http://library.seg.org/page/policies/terms
DOI:10.1190/geo2022-0159.1

ω

to obtain the input image of the CNN, where ps ðx; z; ωÞ and
pg ðx; z; ωÞ are the forward-propagated source wavefield and the
backward-propagated receiver wavefield, respectively, and ⋄ represents the complex conjugate.

U-net for enhancing one-way wave equation-based
migration image
The image produced by one-way wave equation-based migration
can be regarded as

where P1 denotes the actual image obtained by one-way wave
migration, I 1 is the corresponding true image, and α represents
the artifacts and errors. Similarly, the image produced by twoway wave equation-based migration can be expressed as

P2 ¼ I 2 þ β;

where P2 is the actual RTM result and I 2 and β represent the true
image and the RTM artifacts, respectively. To reduce the influence
of β on P2 as much as possible, we use the Laplacian filter (Youn
and Zhou, 2001) to attenuate the artifact β.
We use a U-net to establish the mapping relationship from P1 to P2 . The label of the U-net is
the image produced by two-way wave migration,
and the input is the result produced by one-way
wave migration. Here, β is greatly attenuated by
the Laplacian filter. In addition, because I 1 and α
have almost no similarities to β, it is difficult to
capture the similarities by the U-net and use them
to create I 1 − β and α − β connections; therefore,
the mapping relationship from P1 to P2 is essentially the mapping relationship from P1 to I 2 .
Thus, training the U-net is similar to fitting a
function f, and we have

I 2 ¼ fðP1 Þ ¼ fðI 1 þ αÞ:

(12)

Because α and I 2 share almost no structural similarities, the ideal function f removes α and corrects I 1 to ensure that it is as similar to I 2 as
possible.
We train and validate two networks (U-net1 and
U-net2) with different depths for comparison. The
U-net topologies are shown in Figures 1 and 2.
The U-net structure can be divided into two main components: downsampling and upsampling. In Figure 2, the structure of the encoding
block is displayed in the azure rectangle. The different encoding
blocks are ResNets with different convolution kernels or weights.
The ResNets are introduced to solve the degradation problem caused
by the increased network depth, allowing the CNN to increase the
depth to extract more target features and become easier to optimize.
The mapping that results due to the addition of the ResNets is sensitive to changes in the output. The network inside the brown rectangle in Figure 2 represents the decoding block, with the interpolation
function and different ResNets forming different decoding blocks. Unet structures can identify target characteristics at different scales.
The skip concatenations introduce original features with different
scales to restore the target scale, and these original features can
modify the output of the network.
Three loss functions are used to train U-net1 and U-net2: the
mean absolute error (MAE), the mean-squared error (MSE), and
SmoothL1. These loss functions are expressed in equations 13, 14,
and 15, respectively. Here, m and n denote the outputs and labels of
the CNN, respectively; q is the total number of elements in a batch;
and θ is a variable that can be selected by the user. Due to the limitation of GSP’s one-way attribute, GSP-based migration images
contain many artifacts and outliers. At the beginning of training,
these outliers are likely to be passed to the network output, causing

Figure 2. The topology of U-net2. The details of the encoding and decoding blocks are
shown in the azure and brown rectangles, respectively. In the encoding blocks, a ResNet
acts as an encoding block; these ResNets have the same structure and different convolution
kernels or weights. The image size determines whether the operations in the parentheses
are performed. An encoding operation consists of a certain number of encoding blocks.
The decoding block consists of an interpolation (IPN) function and a ResNet.

Figure 3. (a) True velocity model and (b) migration velocity model.

(11)

Downloaded 01/17/23 to 202.38.84.171. Redistribution subject to SEG license or copyright; see Terms of Use at http://library.seg.org/page/policies/terms
DOI:10.1190/geo2022-0159.1

Enhancing one-way wave migration

WA109

the MSE network to be unstable. However, the
MSE network has a relatively stable gradient
when the loss is close to zero as well as a relatively fast convergence speed. The l1 norm of the
difference between the output and the label is insensitive to outliers in the output. Nonetheless, it
is difficult for the MAE network to calculate an
effective gradient when the loss is close to zero.
If we choose a reasonable θ, the SmoothL1 network has the advantages of the first two networks
(Girshick, 2015)

1X
jm − nj j;
q j¼1 j

(13)

1X
ðm − nj Þ2 ;
q j¼1 j

(14)

q

MAEðm; nÞ ¼

q

MSEðm; nÞ ¼

SmoothL1ðm;nÞ
8 P
< 1 qj¼1 ½0.5ðmj −nj Þ2 =θ; if jmj −nj j<θ
q
¼ 1 Pq
:
:
otherwise
j¼1 ½jmj −nj j−0.5θ;
q

Figure 4. The velocity models and the results of one-way wave migration and RTM.
(a) The rectangular area from Figure 3a, (b) the GSP-based migration image for the
model shown in (a), (c) the RTM image for the model shown in (a), (d) a model including formations with large dips, (e) the GSP-based migration image for the model
shown in (d), and (f) the RTM image for the model shown in (d).

(15)
DATA SET ESTABLISHMENT
Migration image
Because our neural network models are designed to act on migration images, we need to
compute the migration images to build the data
set. A true velocity model is shown in Figure 3a.
Figure 3b depicts a smooth version of the model,
which is used for migration. We use the true
model to generate synthetic data. The source is
defined by a Ricker wavelet with a dominant
frequency of 25 Hz. The grid spacing is 5 m.
The source is distributed across the surface, with
a source spacing of 80 m. Geophones are distributed on both sides of the source with a spatial interval of 5 m and a maximum offset of 2.5 km. We
crop the adequately illuminated part of the RTM
image to use as a high-quality label. Similarly, the
input is a cropped GSP-based migration image. It
should be noted that all of the images and velocity
models shown in the following have been freely
cropped. Figure 4a shows the velocity model from
the rectangular box in Figure 3a. The GSP-based
migration image corresponding to Figure 4a is
shown in Figure 4b, whereas Figure 4c displays
the corresponding RTM image. The one-way
wave equation-based migration image has some
artifacts, and the structure at this depth is indistinct. Compared with the true model, the spatial
position of the structure (such as the peak of
the uppermost anticline) in the migration image

Figure 5. The SEG/EAGE overthrust model as well as its variant and slices. (a) The SEG/
EAGE overthrust model, (b) a variant of the SEG/EAGE overthrust model, (c) the velocities extracted from the models shown in (a and b) along the black line indicated in (a),
(d) slice model 1, (e) slice model 2, (f) slice model 3, (g) slice model 4, and (h) slice
model 5.

Yu et al.

Downloaded 01/17/23 to 202.38.84.171. Redistribution subject to SEG license or copyright; see Terms of Use at http://library.seg.org/page/policies/terms
DOI:10.1190/geo2022-0159.1

WA110

is higher than the true position. These issues are not present in the
two-way wave equation-based migration image.
When the model includes large inclination structures and severe
lateral velocity variations, the wavefield and image calculated by
GSP are biased. Figure 4e and 4f shows the GSP-based migration
image and RTM image, respectively, for the model shown in Figure 4d. There are numerous artifacts in the GSP-based migration
image. Most of these errors are caused by strong lateral velocity
differences. In contrast, the RTM image is clear and has few artifacts. Low-frequency artifacts in the RTM image can be attenuated
with a simple Laplacian filter. Due to the preceding features of the
RTM image, we use RTM images as the labels in our work.
To ensure the richness of the U-net input samples, the migration
parameters were defined with large ranges. The dominant frequency
of the Ricker wavelet ranged from 17 to 40 Hz. The grid spacing
(geophone spacing) ranged from 2.5 to 6 m. The maximum offset

ranged from 1.5 to 3.5 km. The source spacing varied between 20
and 100 m.

Expansion of velocity models
Rich data sets are required for neural network training, verification, and testing. To expand the data sets, several velocity models
have been developed. Some methods for expanding the velocity

Table 1. The proportion of different types of models.

Type

Proportion (%)

T01

T02

T03

T04

T05

58.8

14.9

12.4

7.8

6.1

T01: simple models, such as those shown in Figure 4a and 4d; T02: models derived
from the Marmousi model; T03: models derived from the overthrust model; T04:
models with steep faults; and T05: models with steep salt domes.

Figure 6. Loss convergence curves for the combination of U-net2
and SmoothL1.

Figure 7. The CNN model outputs for the input shown in Figure 4.
(a) The output for the input shown in Figure 4b; (b) the amplitudes
of the images shown in Figure 4b, 4c, and (a) (distance = 0.7 km and
depth = 0–1.28 km); (c) the output for the input shown in Figure 4e;
(d) the amplitudes of the images shown in Figure 4e, 4f, and (c) (distance = 0.1 km and depth = 0–1.28 km); and (e) the amplitudes
extracted from the images shown in Figure 4e, 4f, and (c) along
the dashed black line indicated in Figure 4d (note that the image
amplitudes are normalized to facilitate comparison of the relative
magnitude of artifacts).

Table 2. The average losses and SSIMs of different combinations for the validation and test sets.

U-net1
Outputs
Average loss
Average SSIM

U-net2

MAE

MSE

SmoothL1

MAE

MSE

SmoothL1

0.0555  0.0001
0.91  0.01

0.0633  0.0001
0.90  0.01

0.0634  0.0001
0.89  0.01

0.0533  0.0001
0.92  0.01

0.0581  0.0001
0.91  0.01

0.0527  0.0001
0.92  0.01

To facilitate comparison, the output losses are uniformly calculated based on the MAE; the corresponding average SSIM of the inputs is 0.23.

Downloaded 01/17/23 to 202.38.84.171. Redistribution subject to SEG license or copyright; see Terms of Use at http://library.seg.org/page/policies/terms
DOI:10.1190/geo2022-0159.1

Enhancing one-way wave migration
models include cropping, rotation, vertical (or horizontal) interpolation, vertical (or horizontal) flips, and outward expansion (by horizontally copying the value of the model boundary). We apply one or
more of these operations to enrich our model.
Figure 5a shows the SEG/EAGE overthrust model, whereas
Figure 5b depicts its variant. Figure 5c exhibits the velocities extracted from the overthrust model and its variant along the black line
in Figure 5a. Compared with the overthrust model, its variant has a
wider velocity range and a larger average velocity gradient, allowing
RTM to image steep structures. Based on the overthrust model and its
variant, we have designed the models shown in Figure 5d and 5e.
Moreover, we also have introduced some special structures into
the generated models, as shown in Figure 5f–5h.
Our model library also includes models based on the benchmark
Marmousi model. The models discussed previously are only a subset of our model library, with
each type of model occupying a reasonable proportion of the library. The detailed proportions
are shown in Table 1.

WA111

RESULTS
To generate the results for the validation and test sets, the U-net2
model with SmoothL1 is the ideal CNN model. Figure 7a shows the
output of the network for the migration image in Figure 4b. Compared with the input, the deep structures are visible in the output.
Figure 7b shows the amplitudes extracted along the line (distance = 0.7 km and depth = 0–1.28 km) in the migration images
in Figures 4b, 4c, and 7a. Compared with the input, the output
has an improved amplitude that essentially corresponds to the
amplitude of the label. The same situation can be observed in
Figures 4e, 4f, 7c, and 7d. In addition, the trained network effectively removes the artifacts in the input shown in Figure 4e caused
by the large horizontal velocity perturbations, and thus the output

TRAINING AND VALIDATION
U-net1 and three loss functions are combined
individually for training and validation, with the
same operations applied to U-net2. We have
2889 pairs of input and label, of which the validation set accounts for approximately 10% and the
rest is the training set. We use PyTorch version
1.10.0 on a GeForce RTX 3090 graphics processing unit (GPU) for training and validation. The
average losses of different combinations for the
validation and test sets after 200 epochs of training
are provided in Table 2. To facilitate comparison,
the average losses are uniformly calculated based
on the MAE. To quantitatively evaluate the effectiveness of different combinations, the structural
similarity index measure (SSIM) is introduced
(Avila et al., 2021) by

SSIM ¼

ð2μo μl þ C1 Þð2σ ol þ C2 Þ
;
2
ðμo þ μ2l þ C1 Þðσ 2o þ σ 2l þ C2 Þ
(16)

where μo and μl are the mean values of o and
l, respectively; σ ol represents their covariance;
and σ 2 represents the variance. In addition, C1 ¼
ð0.01LÞ2 and C2 ¼ ð0.03LÞ2 , where L is the
value range of the image amplitude. Here, l represents the CNN label and o refers to either the output or the input. For the validation and test sets, the
average SSIM of the inputs is 0.23. The corresponding average SSIMs for the outputs of different combinations are shown in Table 2. The model
with U-net2 and SmoothL1 has the lowest average
loss and the highest average SSIM. The model
with U-net2 and SmoothL1 greatly improves the
average SSIM of the inputs. The convergence
curve of this model during training is shown in
Figure 6.

Figure 8. The inputs and outputs for the models displayed in Figure 5. (a) The GSPbased migration result for the model in Figure 5d, (b) the output for the input shown in
(a), (c) the GSP-based migration result for the model in Figure 5e, (d) the output for the
input shown in (c), (e) the GSP-based migration result for the model in Figure 5f, (f) the
output for the input shown in (e), (g) the GSP-based migration result for the model in
Figure 5g, (h) the output for the input shown in (g), (i) the GSP-based migration result
for the model in Figure 5h, and (j) the output for the input shown in (i).

Downloaded 01/17/23 to 202.38.84.171. Redistribution subject to SEG license or copyright; see Terms of Use at http://library.seg.org/page/policies/terms
DOI:10.1190/geo2022-0159.1

WA112

Yu et al.

shown in Figure 7c contains very few artifacts. There is no velocity
difference at the position of the dashed black line in Figure 4d, in
which the image amplitude should be zero. Figure 7e shows the
amplitudes of the images displayed in Figures 4e, 4f, and 7c at this
location, and it demonstrates that our method has the function of
artifact attenuation.
The CNN model also performs well for complex models.
Figure 5d depicts a fault model, and its GSP-based migration image is shown in Figure 8a. The image contrast at the bottom of
Figure 8a is very low, and the fault in the black rectangular frame
is unrecognizable. As shown in Figure 8b, our network model restores the fault structure and enhances the contrast in the deep
area. When the formation has a very large inclination (Figure 5e),
GSP-based migration has difficulty recovering the structure (Figure 8c). In the input image, the inclined strata are visually separated, and it is difficult to determine whether the structures
between the separated strata are artifacts. Figure 8d shows how
our CNN model recovered the fault structure displaying a clear
image. High-velocity anomalies such as salt domes often have
steep boundaries and strong velocity contrast, as shown in Figure 5f,
and imaging these structures with one-way wave equation-based
migration is challenging. The GSP-based migration image shown
in Figure 8e has had difficulty restoring the steep boundaries. However, in the network output result (Figure 8f), the boundaries
are clearly recovered. Similarly, the CNN model can reconstruct images of steep fault planes. Figure 8g and 8h and Figure 8i and 8j

Figure 9. (a) The Marmousi model, (b) the GSP-based migration
result, (c) the CNN output, (d) the RTM result, and (e–h) the magnifications of (a–d) in the red focus area shown in (a), respectively.

depict two pairs of inputs and outputs with steep faults with the corresponding models shown in Figure 5g and 5h, respectively. Compared with the inputs, the output images of the steep interfaces are
significantly improved. The structure indicated by the black arrow in
Figure 8g is improved in Figure 8h. Furthermore, the image shown in
the black rectangular frame in Figure 8i is clearly illustrated in
Figure 8j.
Moreover, we use the CNN model to process a larger image.
Figure 9a shows the Marmousi model, with Figure 9b depicting
the corresponding GSP-based image. The images in the training
set are all 256 × 288 (points). However, the size of the image in
Figure 9b is 388 × 848. Our network structure has an implicit
nature that can naturally handle images of any size. With the input
in Figure 9b, we can obtain higher resolution output, as shown in
Figure 9c. The images of the interfaces, especially near the red
arrow in Figure 9a, have been enhanced. In the area below the
arrow in the model, the output has fewer artifacts and clearer structures than the input. Figure 9d shows the corresponding RTM result, and Figure 9e–9h shows the magnifications of Figure 9a–9d
in the red focus area shown in Figure 9a, respectively. Figure 9e–
9h clearly shows that our method has a higher resolution than
GSP-based migration and RTM in these cases. To verify the generalizability of our CNN model, we take the GSP-based migration
image for a slice of the 3D SEG/EAGE salt model (Figure 10a) as
the CNN input (Figure 10b). Note that our velocity model library
does not cover the 3D SEG/EAGE salt model. The CNN output
shown in Figure 10c has a higher resolution than the input, especially for the salt dome boundary indicated by the red arrows

Figure 10. (a) A profile of the 3D SEG/EAGE salt model, (b) the
GSP-based migration result, (c) the CNN output, (d) the RTM image, and (e–h) the magnifications of (a–d) in the area indicated by
the upper red arrow in (a), respectively. Note the phase improvement of (g) compared with (f).

Enhancing one-way wave migration

WA113

Downloaded 01/17/23 to 202.38.84.171. Redistribution subject to SEG license or copyright; see Terms of Use at http://library.seg.org/page/policies/terms
DOI:10.1190/geo2022-0159.1

Table 3. The SSIMs for the inputs and outputs of the velocity models.

Figure (Model) label

Input
Output

4a

4d

5d

5e

5f

5g

5h

9a

0.23  0.01
0.96  0.01

0.08  0.01
0.99  0.01

0.22  0.01
0.91  0.01

0.23  0.01
0.94  0.01

0.27  0.01
0.94  0.01

0.20  0.01
0.93  0.01

0.22  0.01
0.94  0.01

0.03  0.01
0.68  0.01

shown in Figure 10a. Figure 10d exhibits the corresponding RTM
image. Figure 10e–10h shows the magnifications of Figure 10a–
10d in the area indicated by the upper red arrow in Figure 10a,
respectively. The comparisons of Figure 10e–10h indicate that
our method can improve the image of one-way wave equationbased migration. However, it is still challenging for the network
to deal with such a steep and subtle salt boundary, allowing for
absolutely nothing here in the input image.
The SSIMs of the preceding numerical examples are listed in
Table 3. It is clear from Tables 2 and 3 that our network greatly
improves the SSIMs between the GSP-based migration images and
the RTM images. Thus, with our CNN model, the migration results
based on the one-way wave propagator are as close as possible to the
RTM results based on the two-way wave propagator.
Although the RTM can be used to accurately image complex
structures, it has a considerable computational cost. The use of
a one-way wave propagator rather than a two-way wave propagator for migration can save substantial calculation costs. With the
same CPU usage, the calculation time of the RTM image is approximately 4.2 times that of the GSP-based migration image.
Our CNN model generates an output from a GSP-based migration
image in seconds. As discussed previously, the proposed method
compensates for the shortcomings of one-way wave equationbased migration while saving considerable calculation costs in
subsurface investigations.

CONCLUSION
We have proposed a method for improving one-way wave
equation-based migration images by using CNN. The CNN
mimics U-net and uses residual neural networks (ResNets) to
improve its performance. The input of the network is the result
of a one-way wave equation migration based on a GSP. The label
is an RTM result, which has high imaging accuracy. We have
tuned the network with different depths and different loss functions and tested the corresponding network models to obtain an
ideal network model.
Although the GSP-based migration has lower calculation costs
than RTM with a two-way wave propagator, it has difficulties handling steep structures and considerable velocity contrast. The ideal
CNN model improves the resolution of the GSP-based migration
image while removing the errors and artifacts caused by large horizontal velocity perturbations. Furthermore, because the proposed
CNN model significantly mitigates amplitude deviations in the
GSP-based migration image, the output image can precisely depict
formations with large dips. With our CNN model, the GSP-based
migration image is as close as possible to the RTM image, and the
SSIM between the GSP-based migration result and the RTM result
is improved. In addition to generating accurate imaging results, the

computational burden of GSP-based migration with our CNN
model is considerably lower than that of conventional RTM. The
method described in this paper has potential applications in realworld subsurface investigations. In addition, our method provides
a new CNN application mode that improves one migration method
by learning from another one.

ACKNOWLEDGMENTS
This study is supported by the National Natural Science Foundation of China (nos. 42074125 and 41774121). We deeply thank
the editors and three anonymous reviewers for helping us improve
this paper.

DATA AND MATERIALS AVAILABILITY
Data associated with this research are available and can be
obtained by contacting the corresponding author.

REFERENCES
Anderson, J. E., L. Tan, and D. Wang, 2012, Time-reversal checkpointing
methods for RTM and FWI: Geophysics, 77, no. 4, S93–S103, doi: 10
.1190/geo2011-0114.1.
Avila, M. R. V., L. N. Osorio, J. de Castro Vargas Fernandes, A. Bulcão, B.
Pereira-Dias, B. de Souza Silva, P. M. Barros, L. Landau, and A. G. Evsukoff, 2021, Migration deconvolution via deep learning: Pure and Applied Geophysics, 178, 1677–1695, doi: 10.1007/s00024-021-02707-0.
Baysal, E., D. D. Kosloff, and J. W. C. Sherwood, 1983, Reverse time
migration: Geophysics, 48, 1514–1524, doi: 10.1190/1.1441434.
Claerbout, J. F., 1970, Coarse grid calculations of waves in inhomogeneous
media with application to delineation of complicated seismic structure:
Geophysics, 35, 407–418, doi: 10.1190/1.1440103.
Etgen, J., S. H. Gray, and Y. Zhang, 2009, An overview of depth imaging in
exploration geophysics: Geophysics, 74, no. 6, WCA5–WCA17, doi: 10
.1190/1.3223188.
Fei, T. W., Y. Luo, J. Yang, H. Liu, and F. Qin, 2015, Removing false images
in reverse time migration: The concept of de-primary: Geophysics, 80,
no. 6, S237–S244, doi: 10.1190/geo2015-0289.1.
Fletcher, R. F., P. Fowler, P. Kitchenside, and U. Albertin, 2005, Suppressing
artifacts in prestack reverse time migration: 75th Annual International
Meeting, SEG, Expanded Abstracts, 2049–2051, doi: 10.1190/1.2148113.
Fletcher, R. P., P. J. Fowler, P. Kitchenside, and U. Albertin, 2006, Suppressing unwanted internal reflections in prestack reverse-time migration:
Geophysics, 71, no. 6, E79–E82, doi: 10.1190/1.2356319.
Girshick, R., 2015, Fast R-CNN: Proceedings of the IEEE International
Conference on Computer Vision, 1440–1448.
Griewank, A., 1992, Achieving logarithmic growth of temporal and spatial
complexity in reverse automatic differentiation: Optimization Methods
and Software, 1, 35–54, doi: 10.1080/10556789208805505.
Griewank, A., and A. Walther, 2000, Algorithm 799: Revolve: An implementation of checkpointing for the reverse or adjoint mode of computational differentiation: ACM Transactions on Mathematical Software, 26,
19–45, doi: 10.1145/347837.347846.
Grimbergen, J. L. T., F. J. Dessing, and K. Wapenaar, 1998, Modal expansion of one-way operators in laterally varying media: Geophysics, 63,
995–1005, doi: 10.1190/1.1444410.

Downloaded 01/17/23 to 202.38.84.171. Redistribution subject to SEG license or copyright; see Terms of Use at http://library.seg.org/page/policies/terms
DOI:10.1190/geo2022-0159.1

WA114

Yu et al.

Guitton, A., B. Kaelin, and B. Biondi, 2007, Least-squares attenuation of
reverse-time-migration artifacts: Geophysics, 72, no. 1, S19–S23, doi:
10.1190/1.2399367.
Huang, J., and R. L. Nowack, 2020, Machine learning using U-net convolutional neural networks for the imaging of sparse seismic data: Pure and
Applied Geophysics, 177, 2685–2700, doi: 10.1007/s00024-019-02412-z.
Huang, L.-J., M. C. Fehler, and R.-S. Wu, 1999, Extended local born Fourier
migration method: Geophysics, 64, 1524–1534, doi: 10.1190/1.1444656.
Jia, X., W. Chen, and B. Chen, 2020, An efficient super-virtual shot encoding scheme for multisource reverse time migration: Geophysics, 85, no. 6,
S405–S416, doi: 10.1190/geo2019-0479.1.
Jia, X., and R.-S. Wu, 2009, Superwide-angle one-way wave propagator and
its application in imaging steep salt flanks: Geophysics, 74, no. 4, S75–
S83, doi: 10.1190/1.3124686.
Jing, X., C. J. Finn, T. A. Dickens, and D. E. Willen, 2000, Encoding multiple shot gathers in prestack migration: 70th Annual International Meeting,
SEG, Expanded Abstracts, 786–789, doi: 10.1190/1.1816188.
Leveille, J. P., I. F. Jones, Z.-Z. Zhou, B. Wang, and F. Liu, 2011, Subsalt
imaging for exploration, production, and development: A review: Geophysics, 76, no. 5, WB3–WB20, doi: 10.1190/geo2011-0156.1.
Li, S., B. Liu, Y. Ren, Y. Chen, S. Yang, Y. Wang, and P. Jiang, 2020, Deep
learning inversion of seismic data: IEEE Transactions on Geoscience and
Remote Sensing, 58, 2135–2149, doi: 10.1109/TGRS.2019.2953473.
Liu, F., S. A. Morton, J. P. Leveille, and G. Zhang, 2007, Reverse-time migration using one-way wavefield imaging condition: 77th Annual International Meeting, SEG, Expanded Abstracts, 2170–2174, doi: 10.1190/1
.2792917.
Liu, F., G. Zhang, S. A. Morton, and J. P. Leveille, 2011, An effective imaging condition for reverse-time migration using wavefield decomposition: Geophysics, 76, no. 1, S29–S39, doi: 10.1190/1.3533914.
McMechan, G. A., 1983, Migration by extrapolation of time-dependent
boundary values: Geophysical Prospecting, 31, 413–420, doi: 10.1111/
j.1365-2478.1983.tb01060.x.
Morton, S. A., and C. C. Ober, 1998, Faster shot-record depth migrations using phase encoding: 68th Annual International Meeting, SEG, Expanded
Abstracts, 1131–1134, doi: 10.1190/1.1820088.
Mulder, W. A., and R.-E. Plessix, 2003, One-way and two-way wave-equation migration: 73rd Annual International Meeting, SEG, Expanded
Abstracts, 881–884, doi: 10.1190/1.1818081.
Mulder, W. A., and R.-E. Plessix, 2004, A comparison between one-way and
two-way wave-equation migration: Geophysics, 69, 1491–1504, doi: 10
.1190/1.1836822.
Perrone, F., and P. Sava, 2012, Wave-equation migration with dithered plane
waves: Geophysical Prospecting, 60, 444–465, doi: 10.1111/j.1365-2478
.2011.01011.x.
Richardson, A., and C. Feller, 2019, Seismic data denoising and deblending using deep learning, https://arxiv.org/abs/1907.01497, accessed 23 January 2022.
Ristow, D., and T. Rühl, 1994, Fourier finite-difference migration: Geophysics, 59, 1882–1893, doi: 10.1190/1.1443575.
Rocha, D., N. Tanushev, and P. Sava, 2016, Acoustic wavefield imaging
using the energy norm: Geophysics, 81, no. 4, S151–S163, doi: 10
.1190/geo2015-0486.1.
Ronneberger, O., P. Fischer, and T. Brox, 2015, U-net: Convolutional networks
for biomedical image segmentation, in N. Navab, J. Hornegger, W. Wells,
and A. Frangi, eds., Medical image computing and computer-assisted intervention, Lecture Notes in Computer Science 9351: Springer, 234–241, doi:
10.1007/978-3-319-24574-4_28.
Sandberg, K., and G. Beylkin, 2009, Full-wave-equation depth extrapolation
for migration: Geophysics, 74, no. 6, WCA121–WCA128, doi: 10.1190/1
.3202535.
Shi, Y., X. Wu, and S. Fomel, 2019, SaltSeg: Automatic 3D salt segmentation using a deep convolutional neural network: Interpretation, 7, no. 3,
SE113–SE122, doi: 10.1190/INT-2018-0235.1.
Shragge, J., and G. Shan, 2008, Prestack wave-equation depth migration in
elliptical coordinates: Geophysics, 73, no. 5, S169–S175, doi: 10.1190/1
.2956349.

Song, H., J. Zhang, and Y. Zou, 2022, Direct expansion of Fourier extrapolator for one-way wave equation using Chebyshev polynomials of the second kind: Geophysics, 87, no. 2, S63–S73, doi: 10.1190/geo2021-0114.1.
Stoffa, P. L., J. T. Fokkema, R. M. de Luna Freire, and W. P. Kessinger, 1990,
Split-step Fourier migration: Geophysics, 55, 410–421, doi: 10.1190/1
.1442850.
Sun, Y., Y. Liu, G. Wang, and H. Zhang, 2017, Deep learning for plant identification in natural environment: Computational Intelligence and Neuroscience, 2017, 7361042, doi: 10.1155/2017/7361042.
Symes, W. W., 2007, Reverse time migration with optimal checkpointing:
Geophysics, 72, no. 5, SM213–SM221, doi: 10.1190/1.2742686.
Wang, W., G. A. McMechan, and J. Ma, 2021, Elastic isotropic and anisotropic full-waveform inversions using automatic differentiation for gradient calculations in a framework of recurrent neural networks:
Geophysics, 86, no. 6, R795–R810, doi: 10.1190/geo2020-0542.1.
Wu, R.-S., 1994, Wide-angle elastic wave one-way propagation in heterogeneous media and an elastic wave complex-screen method: Journal of
Geophysical Research: Solid Earth, 99, 751–766, doi: 10.1029/93JB02518.
Wu, X., Z. Geng, Y. Shi, N. Pham, S. Fomel, and G. Caumon, 2020, Building realistic structure models to train convolutional neural networks for
seismic structural interpretation: Geophysics, 85, no. 4, WA27–WA39,
doi: 10.1190/geo2019-0375.1.
Xie, X.-B., and R.-S. Wu, 1998, Improve the wide angle accuracy of screen
method under large contrast: 68th Annual International Meeting, SEG,
Expanded Abstracts, 1811–1814, doi: 10.1190/1.1820283.
Yang, F., and J. Ma, 2019, Deep-learning inversion: A next-generation seismic velocity model building method: Geophysics, 84, no. 4, R583–R599,
doi: 10.1190/geo2018-0249.1.
Yang, P., R. Brossier, L. Métivier, and J. Virieux, 2016, Wavefield
reconstruction in attenuating media: A checkpointing-assisted reverse-forward simulation method: Geophysics, 81, no. 6, R349–R362, doi: 10
.1190/geo2016-0082.1.
Yi, H., and K.-H. N. Bui, 2020, An automated hyperparameter search-based
deep learning model for highway traffic prediction: IEEE Transactions on
Intelligent Transportation Systems, 22, 5486–5495, doi: 10.1109/TITS
.2020.2987614.
Yoon, K., and K. J. Marfurt, 2006, Reverse-time migration using the pointing
vector: Exploration Geophysics, 37, 102–107, doi: 10.1071/EG06102.
You, J., J. Cao, and J. Wang, 2020, Two-way wave equation prestack depth
migration using the matrix decomposition theory: Chinese Journal of
Geophysics, 63, 3838–3848, doi: 10.6038/cjg2020O0027.
Youn, O. K., and H.-W. Zhou, 2001, Depth imaging with multiples: Geophysics, 66, 246–255, doi: 10.1190/1.1444901.
Yuan, S., J. Liu, S. Wang, T. Wang, and P. Shi, 2018, Seismic waveform
classification and first-break picking using convolution neural networks:
IEEE Geoscience and Remote Sensing Letters, 15, 272–276, doi: 10
.1109/LGRS.2017.2785834.
Zhang, J.-H., W.-M. Wang, S.-Q. Wang, and Z.-X. Yao, 2010, Optimized
Chebyshev Fourier migration: A wide-angle dual-domain method for media with strong velocity contrasts: Geophysics, 75, no. 2, S23–S34, doi:
10.1190/1.3350861.
Zhang, J.-H., and Z.-X. Yao, 2011, Reducing two-way splitting error of FFD
method in dual domains: Geophysics, 76, no. 4, S165–S175, doi: 10.1190/1
.3590214.
Zhang, W., J. Gao, T. Yang, X. Jiang, and W. Sun, 2021, Least-squares reverse time migration using convolutional neural networks: Geophysics,
86, no. 6, R959–R971, doi: 10.1190/geo2021-0006.1.
Zhang, Y., and J. Sun, 2009, Practical issues in reverse time migration: True
amplitude gathers, noise removal and harmonic source encoding: First
Break, 27, 53–59, doi: 10.3997/1365-2397.2009002.
Zhao, Z., M. K. Sen, and P. L. Stoffa, 2016, Double-plane-wave reverse time
migration in the frequency domain: Geophysics, 81, no. 5, S367–S382,
doi: 10.1190/geo2015-0687.1.

Biographies and photographs of the authors are not available.

