IEEE TRANSACTIONS ON GEOSCIENCE AND REMOTE SENSING, VOL. 61, 2023

5904313

Autoencoded Elastic Wave-Equation Traveltime
Inversion: Toward Reliable Near-Surface Tomogram
Chang Zhang, Jing Li , Member, IEEE, Han Yu, and Bin Liu

Abstract— Due to unexpected environmental variations and
poor consistencies in land data acquisition, complex near-surface
seismograms are usually polluted unreasonably with a low signalto-noise ratio (SNR). These complicated circumstances bring
more challenges in identifying accurate first arrivals for the
following wave-equation traveltime (WT) inversion. Recently, the
autoencoder (AE) is a typical unsupervised learning network,
whose basic principle is to compress the input seismic data for
their intrinsic features in the latent space with an encoder and,
thereafter, to decipher these features for seismic profiles as the
output with a decoder. This process is fully automatic with high
stability and is not very sensitive to data quality. In this article,
we propose an elastic WT inversion algorithm based on the AE
method (AEWT) to invert the P-velocity model. Compared with
the standard WT, the AEWT method automatically extracts the
intrinsic features of the refractions with AE as reference data
for the misfit functionals. Feature images in the latent space
show similar but intensified sensitivity to the traveltimes with
respect to velocity perturbations. We present one synthetic and
two field data tests for comparing the proposed AEWT and the
standard WT tomograms to investigate the locations of a buried
fault and the depth of a buried sinkhole. All these experiments
demonstrate that the proposed elastic AEWT method can reduce
errors caused by low SNR and obtain a more reliable and stable
P-velocity tomogram.
Index Terms— Autoencoder (AE), elastic and acoustic waves,
velocity tomogram, wave-equation traveltime (WT) inversion.

I. I NTRODUCTION

S

EISMIC first-arrival traveltime inversion is one of the
most critical methods to reconstruct the subsurface
P-velocity model. Ray-tracing traveltime tomography (RT)
is a classical method with two significant advantages: good
stability and high computational efficiency [1], [2], [3]. Sava
and Fomel [4] proposed the Huygens wavefront tracing (HWT)
method by combining the minimum traveltime algorithm and

Manuscript received 15 June 2022; revised 16 October 2022 and 4 January
2023; accepted 4 February 2023. Date of publication 6 February 2023; date
of current version 1 March 2023. This work was supported in part by the
National Key Research and Development Program of China under Grant
2022YFC3080200 and in part by the Natural Science Foundation of China
under Grant 42174065 and Grant 42222407. (Corresponding author: Jing Li.)
Chang Zhang and Jing Li are with the College of Geo-Exploration Science and Technology and the Key Laboratory of Applied Geophysics, Jilin
University, Changchun 130026, China (e-mail: ljwy1209@163.com).
Han Yu is with the School of Computer Science, and the Jiangsu Key
Laboratory of Big Data Security and Intelligent Processing, Nanjing University of Posts and Telecommunications, Nanjing 210023, China (e-mail:
han.yu@njupt.edu.cn).
Bin Liu is with the School of Qilu Transportation and the Geotechnical
and Structural Engineering Techniques Research Center, Shandong University,
Jinan 250100, China (e-mail: liubin0635@163.com).
Digital Object Identifier 10.1109/TGRS.2023.3243140

traditional RT methods to perform inversion by tracking rays
elaborately. Leung and Qian [5] introduced a fast sweeping
method to solve the adjoint-state equation. However, the RT
method is limited by the high-frequency hypothesis in forward
modeling techniques, using only part of the information in the
wavefield. It produces a low-resolved, macroscopic velocity
model, and the inversion fails when the wavelength of the
intrinsic velocity of the subsurface model is the same as the
source wavelet [6].
Full-waveform inversion (FWI) is a popular strategy to
improve the velocity tomogram accuracy [7]. Pratt and Worthington [8] developed the frequency-domain FWI method,
which has been widely used in offshore oil exploration fields.
However, the FWI method is highly nonlinear concerning
parametric perturbations of multiphysical fields. Several problems may lead to these difficulties in conducting FWI, such
as cycle skips under inaccurate amplitude modeling, elastic
effects, random noise, and an incorrect initial velocity model.
Consequently, significant challenges emerge in dealing with
complex near-surface land data [9], [10].
To avoid the high-frequency assumption of RT and mitigate
the local minima problem of FWI, Luo and Schuster [11]
proposed the wave-equation traveltime (WT) inversion method
to reconstruct the P-velocity model. The WT method can
provide a more accurate initial velocity model for FWI than
the RT method because it is based on the wave-equation
imaging kernel. It needs more storage memory and computational time because the numerical wavefield should be
estimated and saved for every source. Various modified WT
strategies have been implemented recently in a wide range
of applications. For example, the wave-equation reflection
traveltime inversion (WERTI) utilizes the reflection information [11]. Luo et al. [12] proposed full traveltime inversion
(FTI), where velocity perturbations only cause traveltime
changes, and the inversion only relies on traveltime information. Zhang et al. [13] combined the traveltime, envelope, and
waveform information to adjust the information weights at
different inversion stages to improve the inversion accuracy.
Wang et al. [14] used a single frequency component in the
frequency domain to achieve WT inversion without wavefield
reconstruction, which reduces memory requirements and computational costs.
For the standard WT method, picking traveltime manually
is very time-consuming. This procedure tends to cause a
significant uncertainty error due to the low signal-to-noise ratio
(SNR) of the recorded traces. Yu et al. [15], [16] proposed

1558-0644 © 2023 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission.
See https://www.ieee.org/publications/rights/index.html for more information.

5904313

IEEE TRANSACTIONS ON GEOSCIENCE AND REMOTE SENSING, VOL. 61, 2023

the acoustic WT inversion with the autoencoding technique
(AEWT), which extracts intrinsic features from the refraction
waveforms by the AE network and inverts them for the
subsurface velocity model. Now, the AE method has been
widely used in seismic signal denoising and inversion [17].
It recovers the input data while keeping the feature information
in the latent space and reducing the noise of the output data
in the process of data reconstruction.
Following the previous acoustic AEWT method [15],
we present the elastic AEWT method to invert the P-wave
velocity distributions from land seismic data. The elastic
AEWT tomograms are superior to acoustic AEWT tomograms when significant S-waves are seen in the recorded
seismograms. It is more robust and reliable for applications
in field data. This article uses two synthetic and two field-data
examples to demonstrate the advantages of the proposed
elastic AEWT over the acoustic AEWT and the standard WT
methods. In Section II, we explain the basic theory of an
AE neural network and how AEWT is implemented with
a proposed workflow. In Section III, the synthetic and field
data examples are presented to evaluate the feasibility of the
proposed AEWT, acoustic AEWT, and standard WT methods
in P-velocity tomogram. Finally, in Sections IV and V, the
implications of elastic AEWT inversion capabilities and limitations are discussed.
II. T HEORY OF A EWT M ETHOD
A. Autoencoder (AE) Theory
The AE method was proposed in [18] and has since been
developed in several improved forms, such as convolutional
AE (CAE), variational AEs (VAE), and AE with different
normalization terms [19], [20], [21].
The AE method is equivalent to a lossy signal compression
method but can be constantly trained to minimize the residuals
of the input and the output data [22]. Data at the input
and the output ends are matched iteratively by the trained
AE network. Fig. 1 is a seven-layered AE structure that is
designed to extract intrinsic features of the input data. The
batch normalization (BN) layer can effectively avoid the largescale oscillations in the latent space without affecting the
spatial distribution of the training data. It prevents the training
from falling into a local optimum and better captures the
intrinsic features of the training dataset. Here, the activation
function is set as ReLU [23]. These settings reduce not only
the nonlinearity of the neural network training process but also
the training time. The activation function of the last layer is
set as a sigmoid function, which can normalize the data of
the output layer to the range of [0, 1], in accordance with the
range of the input data.

Fig. 1.

Schematic of the AE method.

where ∆τ (x g , xs ) = τ pre (x g , xs ) − τ obs (x g , xs ) indicates the
traveltime differences between the predicted data (τ pre ) and
the observed data(τ obs ). The subscripts g and s are used to
index the geophones and sources, respectively. The objective
function of AEWT is similar to the standard WT method in
that the seismic traveltime information is replaced with feature
information in AE latent layer [15], [16]
2
1 XX
∆l x g , xs
(2)
ϵ = min
v(x) 2
s
g
where ∆l(x g , xs ) = l pre (x g , xs ) − l obs (x g , xs ) indicates the
difference in feature information between the predicted and
observed data after being encoded from the same training
network. The P-wave velocity distribution v p is updated with
∆v p = 2v p ρ∆λ.

(3)

λ is one of the Lamé parameter, which is used to update
velocity, and the gradient γ (x) is

X X ∂∆l x g , xs

∂ϵ
γ (x) = −
=−
∆l x g , xs . (4)
∂λ(x)
∂λ(x)
s
g
A connection function f is used to relate the seismic data
to the model parameter and obtain an analytic expression for
the gradient equation (4), which is defined as follows [25]:

Z obs


el ∗ +l x g , t; xs pre
 el ∗ x g , t; xs dt
(5)
f x g , t; xs =
Aobs x g , t; xs

B. Inversion Theory of Elastic AEWT

where l ∗ and l ∗ + l indicate the feature information encoded
from the predicted and observed seismic data, respectively.
pre
elobs
∗ +l (x g , t; x s ) and el ∗ (x g , t; x s ) indicate the envelopes of the
observed and the predicted data corresponding to the feature
information.
Aobs (x g , t; xs ) represents the max value of the observed data
for normalization. If the observed and the calculated data agree
with each other, the gradient of connection function is

∂ f x g , t; xs
f˙∆l =
∂l
l=∆l

Z obs

ėl ∗ +1l x g , t; xs pre
 el ∗ x g , t; xs dt = 0
=
(6)
obs
A
x g , t; xs

The standard WT method uses the following objective
function to minimize the traveltime residual [24]
2
1 XX
∆τ x g , xs
(1)
ϵ = min
v(x) 2
s
g

where f˙ and ė denote the first-order previously in WT, and the
dot means the time derivative; now, it represents the derivative
with respect to the latent variable(s) of f and e, respectively;
when l ∗ in (5) is constant, the value of l represents the
actual difference between the two channels of data in the

ZHANG et al.: AUTOENCODED ELASTIC WT INVERSION

5904313

latent layer. When l gradually approaches ∆l, the refraction
waveforms correspond to the true and initial models are closer
to each other. This process is similar to the traveltime getting
progressively matched in the WT method. If the derivative of
the connection function is zero, then the connection function
achieves its maximum value (l = ∆l). The minimization of
seismic waveform differences in the connection function are
represented by reducing their feature difference term ∆l.
Using the implicit function theorem to calculate
(∂∆l(x g , xs )/∂λ(x)), then (4) can be extended as follows:
∂∆l(x)
=
∂λ(x)

∂ f˙
∂λ(x)
∂ f˙
∂∆l(x)

where the denominator is a scaler
Z
 pre

∂ f˙
= ëlobs
x g , t; xs dt = K .
∗ +∆l x g , t; x s el ∗
∂∆l(x)

(7)

(8)

Then, the adjoint-state method [26] is used to derive the
gradient γ for AEWT in Appendix A [27]. It can be written
as follows:
X X 1 ∂ f˙

∆l xg , xs
γ (x) =
K ∂λ(x)
s
g


Z
X

∂w ∂u
=
+
σ̂ x x + σ̂ zz dt
(9)
∂z
∂x
s
where (σ̂ x x , σ̂ zz ) are the adjoint-state variables of (σ x x σzz )
derived in Appendix A. w and u are the horizontal and vertical
velocities, respectively.
The proposed elastic AEWT method is a straightforward
extension of the acoustic AEWT method presented in [15]
and [16]. We need to replace the acoustic finite-difference
modeling with the elastic finite-difference modeling and to
calculate the gradients using the perturbation solution of the
elastic wave equation. In addition, an adaptive window is
chosen based on the approximate velocity range of the first
arrivals. We open a certain window after the first arrivals,
which is used to mute the surface waves and other scattered
waves before applying elastic AEWT.
C. Training AE
The training process of the AE consists of the following
steps.
1) Select an adaptive time window to mute the surface
and other scatter waves. Then, the envelope waveforms are
calculated as input after normalization on the common shot
gather (CSG), and this process reduces the data complexity
for the next training.
2) Tracewise normalization can balance the far-offset and
near-offset distance influence on the network during the training process. On the one hand, the difference in magnitude
between the far offset and the near-offset data is too large,
making it difficult to fit and converge the neural network.
On the other hand, it increases the complexity of the neural
network training process. Taking the trace envelope is also a
simplification of the data, which facilitates the fitting between

Fig. 2.

AEWT inversion flowchart.

the input and the output ends of the neural network and reduces
the training difficulty.
A neural network (NN) with three layers of both the encoder
and the decoder can match the waveforms between the input
and output. If there are small perturbations in the input data,
the output data can be reconstructed when the data residuals
are lower than 1% of the original loss. At this point, the neural
network can be used for AEWT inversion. To speed up the
training process, the Adam optimizer is applied with some
important parameter sets as in [28].
The workflow of AEWT mainly includes the following five
steps (Fig. 2).
1) Generate training data, using the observed or predicted
data with a typical model.
2) Select an adaptive time window for the observed training
samples to mute the surface wave, and some noise disturbances
retain the first arrival waveform.
3) Normalizing the data obtained in 2), taking the envelope
waveform and other data processing methods, and reshaping
the data into a training set.
4) The data obtained in 3) are fed into an AE for training
and recognized by the trained neural network.
5) Iteratively update the inverse velocity model with the
trained neural network until it converges with the conjugate
gradient method [29]. Here, the line-search method is used to
estimate the step length [30].
Network structure: after testing, the AE has seven fully
connected layers, with the number of neurons in each layer
being input-32-2-1-2-32-output. The choice of such a network
structure reduces a lot of neurons in the first layer. The
structure improves the stability and reduces the oscillations
in the residual curves during the training process. The input
and output sections of the network are of the same size as
the length of a seismic trace. A BN layer is added between
the encoder and the latent layer to enhance the ability of the
neural network to learn the features and to reduce the training
time. First, the 2-D velocity model is converted into a set of
1-D seismic traces, and the data are fed into the AE in batch.
The data obtained are in the same format as the initial arrival
of the WT method and finally combined into a 2-D graph and
fed into the inversion program to get the inversion results.
III. N UMERICAL R ESULTS
This section presents the tests with the proposed elastic
AEWT, acoustic AEWT, and standard WT methods on two
synthetic models and two near-surface field datasets from the

5904313

Fig. 3.

IEEE TRANSACTIONS ON GEOSCIENCE AND REMOTE SENSING, VOL. 61, 2023

(a) True P-wave velocity and (b) initial P-wave velocity models.

Fig. 4. (a) First-arrival traveltime matrix of WT and (b) encoding result
matrix of AEWT.

Aqaba fault in Saudi Arabia and a sinkhole site at Park City,
Utah.
A. Synthetic Velocity Model Test
The synthetic P-wave velocity model is a two-layer model
with an irregular interface, in which the model size is
26 m × 120 m [Fig. 3(a)]. The S-wave velocity model is
estimated from the Gardner formula Vp = 1.732 × Vs [31].
A finite-difference algorithm for the 2-D elastic-wave equation
is used to compute 20 shot gathers with 60 geophones evenly
deployed on the free surface with the shot interval of 6 m
and the receiver interval of 2 m in space, respectively. The
source wavelet is a Ricker wavelet with a peak frequency
of 30 Hz. This synthetic test compares the feasibility of the
present elastic AEWT and standard WT methods in P-velocity
tomograms. The initial P-velocity model is a linearly gradient
velocity model, as shown in Fig. 3(b).
Fig. 4(a) and (b) shows the picked first-arrival matrix and
the encoded feature matrix with AEWT, respectively. The
traveltime matrix in Fig. 4(a) reveals the characteristics of the
irregular interface structure. Although the feature encoded by
AE has no explicit physical meaning, it apparently provides a
good feature of the interface structure of the velocity model
[Fig. 4(b)]. Both AEWT and standard WT methods can invert
for high-accuracy velocity tomograms [Fig. 5(a) and (b)]. The
model test demonstrates that the AEWT method can obtain
decent velocity inversion results compared with the standard
WT method using the same inversion parameters.
1) Noise Sensitivity: To test the sensitivity of the proposed
method to the noise, a group of random time shifts and
−20-dB noise (assuming the power of observed data is 0 dB)
are, respectively, added to the raw CSGs [Fig. 6(a) and (d)].
The corresponding AEWT and WT velocity tomograms with

Fig. 5. P-wave velocity tomogram with (a) WT and (b) AEWT (the white
line is the true position of the irregular interface).

random time shifts are shown in Fig. 6(b), (c), (e), and (f).
The AEWT result has higher accuracy than the standard WT
tomogram, where the white line indicates the position of the
interface of the true model.
For the random noisy data, it is challenging to pick accurate
first breaks to be used for the standard WT method. The
corresponding WT tomograms with noisy data are shown in
Fig. 6(e). Due to significant uncertainties and errors in the
picking data, the imaging quality of the standard WT method

ZHANG et al.: AUTOENCODED ELASTIC WT INVERSION

5904313

Fig. 6. (a) CSG data with a group of random shifts, (b) and (c) standard WT and the AEWT tomograms with random shift, (d) −20 dB random noise, and
(e) and (f) WT and the AEWT tomograms with −20 dB noise data.

Fig. 7.

(a) and (d) CSG with different time windows, (b) and (e) standard WT P-velocity tomogram, and (c) and (f) AEWT P-velocity tomogram.

is very low. On the contrary, the AEWT tomogram with noisy
data has good inversion accuracy [Fig. 6(f)]. This sensitivity
test suggests that the AEWT is more robust to the noisy input
data than the standard WT method.
2) Window Muting Test: The adaptive window selection is
another critical parameter affecting the standard WT method.
If the window is too large, it will bring redundant information,
resulting in nonconvergence inversion. If the window is too
small, the first arrival information will be lost, resulting in

low accuracy inversion results. In contrast, AEWT extracts
the intrinsic features of all refraction information in the time
window range (almost one wavelets), not just the first arrival
time. So, the AEWT is not affected by the adaptive window.
The following test compares the effect of the adaptive
time window for AEWT and the standard WT method.
Fig. 7(a) and (d) shows one-shot gather with a different timewindow muting, and Fig. 7(b)–(f) shows the corresponding
standard WT and proposed AEWT P-velocity tomograms.

5904313

IEEE TRANSACTIONS ON GEOSCIENCE AND REMOTE SENSING, VOL. 61, 2023

Fig. 8. Complex low-velocity layer model test [(a) true model, (b) starting model, (c) acoustic AEWT P-velocity tomogram with elastic data, and (d) elastic
AEWT tomogram with elastic data]. Where the black line indicates the interface between the high velocity and low velocity layers.

The results demonstrate that the adaptive window significantly
affects the standard WT method and has little influence on the
AEWT method.
3) Elastic AEWT and Acoustic AEWT: A complex velocity
model is used to test the feasibility of the proposed elastic AEWT and previous acoustic AEWT. Fig. 8(a) shows
this multilayer P-velocity model with the near-surface lowvelocity zone (LVZ), where the S-wave velocity model is also
estimated from the empirical relationship Vp = 1.732 × Vs.
The linearly gradient velocity model is used as the initial
model. Fig. 8(c) is the P-velocity tomogram with acoustic
AEWT. The recorded data have converted S-wave energy,
so the acoustic AEWT tomogram is challenging to reveal
the LVZ layer interface. However, the elastic AEWT method
provides a more accurate inverted velocity model [Fig. 8(d)].
The LVZ layer in the elastic AEWT tomogram is almost
consistent with the interface in the true model, which provides
a reliable initial model for the elastic FWI in the near-surface
application.
B. First Field Example: Gulf of Aqaba Data, Saudi Arabia
Two land datasets are selected for experimental comparisons
of methodologies between the elastic AEWT and the standard
WT method for the P-wave velocity tomogram.
The first seismic experiment was carried out near the Gulf
of Aqaba [Fig. 9(a)]. The survey line is 300 m long with
120 geophones and shots, each with a spacing of 2.5 m. The
sampling interval of seismic records is 1 ms, and the recording
time of each trace is 0.8 s. The survey line crosses the shallow
surface fault structure in the Aqaba area, and a clear fault zone
is visible on the surface [Fig. 9(b)].
CSGs 1, 30, 60, and 90 after data preprocessing are shown
in Fig. 10. The air, Rayleigh wave, reflection, and refraction

Fig. 9. (a) Location of the seismic survey line and (b) photograph shows an
earthquake scarp on the surface [32].

arrivals are indicated in seismic shot gathers. Due to topography and geophone coupling, there is some time shift in
the starting point of different shots, which can be found in
the zero-offset profile [Fig. 11(a)]. The direct wave energy is
not flat at different horizontal positions. We select reference
points to correct shot gathers. The reference points are the
max energy point in traces. The rectified zero offset profile
has good consistency with different shot gathers [Fig. 11(b)].
Fig. 11(c) shows the common offset gathers (COGs) with the
offset of 40 m, in which the events are no longer continuous
everywhere, especially at x = 145 m. The time delays shot
gathers in the distorted area implies that the velocity is smaller
and suggests the location of a possible fault. The processed
CSGs are used as training datasets for the AEWT method.
Fig. 12 shows the encoded Aqaba CSG feature information
matrix for AEWT inversion.
The initial P-velocity model is a gradient velocity model
discretized into 50 × 598 grid points with a grid size of
0.5 m. The AEWT and WT tomograms after 50 iterations
are shown in Fig. 13(a) and (b). The AEWT and WT

ZHANG et al.: AUTOENCODED ELASTIC WT INVERSION

Fig. 10.

5904313

Aqaba seismic data CSG (a) No.1, (b) No.30, (c) No.60, and (d) No.90.

Fig. 12.

Fig. 11.
Aqaba seismic data zero-offset section (a) before correction,
(b) after correction COGs, and (c) offset = 40-m COG.

tomograms suggest that the hidden fault location is at 135 m <
x < 145 m, agreeing very well with the geological map in
Fig. 9(b). However, compared with the standard WT tomogram
[Fig. 13(a)], the AEWT tomogram [Fig. 13(b)] reveals more
details in the bedrock interface. Processed by the AEWT
neural network, the ultimate decoded waveform is smoother
than the input data. Therefore, if there is some intense noise,

Encoded Aqaba CSG matrix for AEWT inversion.

AEWT utilizes the complete information of the data, making
it more stable compared with the standard WT method. The
inverted waveform by AEWT is very close to the raw observed
data [Fig. 14(a)]. The red curves represent the observed data,
and the black curves are the predicted data. The difference
between the observed data and the inversion result of AEWT
is less than that of the WT result [Fig. 14(b)].
For a sanity test, comparing the predicted and observed
COGs is a reliable way to evaluate the accuracy of the velocity
tomogram. Different offset COGs profiles indicate the lateral
velocity variations at different depths. Fig. 15 shows the COG
comparisons of the AEWT inverted data, the standard WT
inverted data, and the raw data at a different offset. All these
COG profiles are able to capture the trend of the observed
events. However, in the COG profile with offset = 37.5 m, the

5904313

IEEE TRANSACTIONS ON GEOSCIENCE AND REMOTE SENSING, VOL. 61, 2023

TABLE I
E RROR P ERCENTAGE OF AEWT AND S TANDARD WT I NVERTED DATA
COG P ROFILE AT D IFFERENT O FFSETS

TABLE II
PARAMETERS OF THE S EISMIC S URVEY OF THE
S INKHOLE AT PARK C ITY, U TAH

Fig. 13.
Aqaba elastic P-wave velocity tomograms with (a) WT and
(b) AEWT methods.

P
RWT =
((|AWT − Aobs |)/Aobs ) represented the errors in
percentage between the predicted data COGs and the observed
data COGs. AAEWT , AWT , and Aobs represent the maximum
amplitude curves of COGs, respectively. Table I shows that
the errors of AEWT at different offset distances are smaller
than the standard WT method, which verifies that the AEWT
velocity tomogram can be more convincible than that with the
standard WT method.
Fig. 14. Waveform comparison between raw and inverted data for (a) AEWT
and (b) standard WT.

C. Second Field Example: Park City Data, Utah

red arrow indicates a high-velocity anomaly [Fig. 15(a)–(c)].
The AEWT [Fig. 15(b)] method recovers the anomaly, while
the WT method [Fig. 15(c)] misses it. The red arrow indicates a low-velocity anomaly in the COG profile with offset = 75 m [Fig. 15(d)–(f)]. The AEWT recovers the COG
downward trend, while WT produces an upward trend. The
red arrow indicates a high-velocity anomaly in the COG
profile with offset = 112.5 m [Fig. 15(g)–(i)]. The AEWT
[Fig. 15(h)] method recovers the anomaly better than the WT
method [Fig. 15(i)]. This comparison suggests that the AEWT
tomogram provides a more accurate velocity model than the
standard WT tomogram.
We also pick the arrival times with maximum amplitudes
from different offset COGs of the events. Fig. 16 compares the
AEWT, the standard WT, and the raw data COGs traveltime
with blue, green, and red lines. The AEWT COGs traveltime
is in good agreement with the raw COGs traveltime, and the
standard WT traveltimes have some errors. This quantitative
traveltime comparisons describe the differences between the
inverted and the raw data in a more accurate sense. It verifies
that the proposed elastic AEWT can obtain more stable and
higher velocity accuracy than the standard WT method for
near-surface seismic field data.
The traveltime errors between the inverted and the raw
data are also compared at thePsame offset distance, as shown
in Table I. RAEWT =
((|AAEWT − Aobs |)/Aobs ) and

The second field dataset is recorded to search for the
extension of an existing sinkhole at Park City, Utah (Fig. 17).
The pond and Sink Hole are parallel to three seismic lines
and perpendicular to the rest of one seismic line. In this work,
it is shown that the position of the sinkhole can be accurately
located with our proposed inversion method. A sledgehammer
hitting a metallic plate is used to excite seismic P-waves,
where each shot location will be fired multiple times for
stacking to increase the SNR of the recorded data. The
associated parameters are shown in Table II, including the
number of shots, geophones, and so on. The survey lines were
used to reveal the sinkholes distributed throughout the work
area. The blue part shows the known sinkholes, whose velocity
is relatively low.
The four survey lines were excited with a sledgehammer
hitting the metal plate, except for the first line, which was
excited five times, and the rest were excited 15 times per shot,
and then, the geophone data were stacked to increase the SNR.
The proposed AEWT method is used to invert for the P-wave
velocity tomogram.
Fig. 18(a)–(d) shows the AEWT P-velocity tomograms
from lines 1 to 4. In line 1, there are no local anomalies.
However, the interface between the bedrock and the soils can
be seen at 6–8 m under the ground. In line 2, two distinct LVZ
represent cavernous rocks at X = 30 m, 80 m in the horizontal
distance and Z = 15 m in depth, respectively [Fig. 18(b)].
At the top of this zone lies one large LVZ in the shallow

ZHANG et al.: AUTOENCODED ELASTIC WT INVERSION

5904313

Fig. 15. (a), (d), and (g) Comparisons of the observed COGs, (b), (e), and (h) AEWT inverted COGs, and (c), (f), and (i) standard WT inverted COGs. The
red arrows depict the event structures.

Fig. 17.

Fig. 16. Arrival times associated with maximum amplitudes for different
offset COGs of AEWT, standard WT, and raw data, respectively.

subsurface at 5 m under the ground. This LVZ corresponds to
a highly saturated soil/rock, indicating the pond’s distribution.
In line 3, there is one LVZ with a depth of 12−16 m and

Aerial map shows the locations of seismic lines.

offsets between 40 and 60 m. Inside LVZ, a lower velocity
value region is within the range of 50 m horizontally and 15 m
deep. These two zones are interpreted to be partly cavernous.
In line 4, LVZ is shown between offsets 14−40 m and depths
10−20 m, consistent with the LVZ in line 2.
Fig. 19 presents the comparisons of four survey lines’
1-D vertical velocity profiles at different coincidence positions. It can be seen that the inverted velocity distributions
of different survey lines at the coincidence position are in

5904313

Fig. 18.

IEEE TRANSACTIONS ON GEOSCIENCE AND REMOTE SENSING, VOL. 61, 2023

Four survey lines AEWT P-velocity tomograms. (a) Line 1, (b) Line 2, (c) Line 3, and (d) Line 4.

Fig. 19. 1-D vertical velocity comparison of AEWT P-velocity tomograms.
(a) Lines 3 and 4, (b) Lines 2 and 3, and (c) Lines 1 and 4.

good agreement. Following the above sanity test, the COG
comparisons of the raw and the inverted data are shown in
Fig. 20. COGs with the AEWT method are consistent with
the raw data COGs. Fig. 21 shows the 3-D spatial distribution
of the four P-velocity tomograms and the actual line location.
The subsurface low-velocity sinkhole anomaly can be verified
and revealed from the P-wave tomograms associated with
the four survey lines. According to the geological survey, the
results show significant agreement with the existing sinkhole.
For example, the velocity distributions of the western edge of
line 2 and the central part of line 3 overlapped. Lines 3 and
4 are connected at the 40th access hole, and the velocity
models between the two survey lines can obviously match
each other. Two holes (blue area in the map) are shown in
the map, which indicate low-velocity anomalies along survey
lines 2, 3, and 4, and the low-velocity location matches the
hole location. Line 1 crosses the sewage pipe, and there may be
high-resistance objects surrounding the sewage pipe, causing
the high resistance anomaly on line 1.
IV. D ISCUSSION
Compared to the standard WT method, the AE strategy does
not need to pick the traveltime information, and the entire
inversion and training processes are completely automatic.
In addition, the AE method is much less sensitive to the first
arrival information than the traditional method. Nevertheless,
the AE inversion requires additional neural network training,
which costs about 10–30 min with one RTX 3080 GPU.

In this study, the same neural network with identical trained
parameters is used for the two model tests and field data
examples. The comparisons of the results between the elastic and the acoustic AEWT methods demonstrate that both
algorithms can produce a reliable P-wave velocity structure
with weak S-wave energy. Elastic AEWT inversion is superior
to its acoustic peer when significant S-waves exist in the
seismograms.
The disadvantage of elastic AEWT inversion is five times
more computationally expensive than the acoustic method. The
AEWT strategy shows better inversion stability and accuracy
for complex velocity structures, especially with low-velocity
layers. Also, tests on the synthetic and real datasets imply
that the AEWT velocity tomograms can be used as a reliable
initial model for FWI. In future work, the elastic AEWT and
waveform inversion method will be tested to invert both the
P-wave and S-wave velocity distributions simultaneously.
V. C ONCLUSION
We propose an elastic WT inversion based on the AE
method (AEWT). The AE network extracts the intrinsic features from low SNR data more efficiently and accurately than
the standard traveltime procedure. Moreover, the feature information obtained by the encoder’s compression dramatically
improves the efficiency of manually picking up the first arrival
information. Numerical experiments on the synthetic models
and two near-surface seismic land datasets verify that the
proposed AEWT method can reduce the uncertainty errors
caused by the inaccurate extraction of first arrival waveform
information and effectively improve the velocity inversion
accuracy. Besides, incorporating the AE methodology into the
WT inversion significantly improves the resulting P-velocity
tomogram and becomes more geologically interpretable. The
AE technique provides a new direction of seismic wave
equation traveltime inversion. Moreover, the near-surface Pwave velocity models obtained from AEWT can be used as
input models for the elastic FWI. In future work, we will
continue to optimize the parameter selections of networks of
AE types (i.e., the transformer) and therefore extending such
inversion applications to more fields with other geophysical
signals.

ZHANG et al.: AUTOENCODED ELASTIC WT INVERSION

5904313

Fig. 20. COG profile comparisons of the observed and the predicted data corresponding to Lines 2 and 4 (a) Raw data COG (Offset=26 m). (b) Raw data
COG (Offset=40.5 m). (c) AEWT Inverted Data COG (Oggset=26 m). (d) AEWT Inverted Data COG (Oggset=40.5 m).

the particle velocity components and stresses. Equation (A1)
can be written as matrix
A
}|

z

Fig. 21. Four survey line distributions of the AEWT P-velocity tomograms
in 3-D space.

A PPENDIX A
In our analysis, we assume that the wave propagation honors
the 2-D isotropic elastic equations


∂
∂
∂
ρ u−
σx x + σx z = 0
∂t
∂x
∂z


∂
∂
∂
ρ w−
σzz +
σx z = 0
∂t
∂z
∂x
∂
∂
∂
σx x = (λ + 2µ) u + λ w + Sx x
∂t
∂x
∂z
∂
∂
∂
σzz = (λ + 2µ) w + λ u + Szz
∂t
∂z
∂

 x
∂
∂
∂
σx z = µ
w+ u
(A1)
∂t
∂x
∂z
where λ and µ represent the Lamé parameter, respectively. Sx x
and Szz denote the source function. (u, wσx x , σzz , σx z ) denote

∂
 ρ ∂t


 0


 −π ∂

∂x

∂

 −λ

∂x

∂
−µ
∂z

0
∂
ρ
∂t
∂
−λ
∂z
∂
−π
∂z
∂
−µ
∂x

∂
−
∂x
0
∂
∂t
0
0

0
∂
−
∂z
0
∂
∂t
0

{
∂
− 
∂z 
∂ 
−

∂x 

0 



0 

∂ 
∂t

w

f

z }| { 
z }| {
u
fx x
 w   f zz 

 

 σx x  =  0  .

 

 σzz   0 
σx z
0

(A2)

According to the adjoint states method, the perturbation of
the state variable w with respect to the model variable m is
given by (∂w(m)/∂m). Model variable m includes the Lamé
parameter λ and µ, and (∂w(m)/∂λ) and (∂w(m)/∂µ) can be
obtained from
A(m)w(m) = F
∂A(m)
∂w(m)
w(m) + A(m)
=0
⇒
∂m i
∂m i
∂w(m)
∂A(m)
⇒
= −A−1 (m)
w(m) (A3)
∂m i
∂m i

5904313

IEEE TRANSACTIONS ON GEOSCIENCE AND REMOTE SENSING, VOL. 61, 2023

where A is the elastic modeling operator in (A2). The connective function in (5) can also be written as follows:
D

obs E
f˙∆l = Ar wl xg , t; xs , ẇl−∆l xg , t; xs
(A4)
where ⟨u, v⟩ represents the inner product between the vectors u
and v and Ar is a sampling operator that samples the wavefield
at the receiver locations, while the adjoint of it, Ar∗ , sprays
the recorded data from the receiver coordinates to the model
coordinates.
The misfit function for AEWT is
2
1 XX
∆l x g , xs
(A5)
ϵ = min
2 s g
and P-wave velocity v p update with
∆v p = 2v p ρ∆λ.

(A6)

The gradient can be written as follows:
∂ϵ
∂λ
∂ f˙
X X ∂λ(x)

=
∆l
x
,
x
g
s
˙
∂f
s

g

∂∆l

X X 1 ∂ f˙

=
∆l xg , xs
K ∂λ(x)
s
g
XX 1 ∂ D
obs E
Ar wl (x, t; xs ), ẇl−∆l xg , t; xs
=
K ∂λ
s
g

×∆l xg , xs

XX ∂wl (x, t; xs )
obs
1
, ẇl−∆l xg , t; xs
∆l xg , xs
=
Ar
∂λ
K
s g


X ∂A
(A7)
wl (x, t; xs ), w∗ (x, t; xs )
=−
∂λ
s
and w∗ = (û, ŵ, σ̂ x x , σ̂ zz , σ̂ x z ) is the adjoint-state variable of w = (u, w, σx x , σzz , σx z ) which is calculated by a
finite-difference solution for the adjoint-state equations of the
elastic wave equation. wl denotes the predicted event for
velocity model recorded at the receiver location xg due to a
obs
source excited at time t = 0 and at location xs while ẇl−∆l
denotes the same event in the observed data.
The adjoint of the elastic equations can be written as
follows:


∂
∂
∂
∂
ρ
0
−π
−λ
−µ
 ∂t
∂x
∂x
∂z 



∂
∂
∂
∂ 
 û

ρ
−λ
−π
−µ
 0


∂t
∂z
∂z
∂ x  ŵ 


 ∂
∂
−
 σ̂ x x 
0
0
0 
 ∂x



∂t

 σ̂ zz 
∂
∂


 0
−
0
0  σ̂ x z


∂z
∂t
 ∂
∂
∂ 
−
−
0
0
∂z
∂x
∂t 

0
 fˆw 



=
 0  (A8)
0 
0

where fˆw is the residual trace that is backpropagated at every
iteration and is given by the following equation:
syn

1
xg , t; xs
∆l xg , xs .
fˆw =
(A9)
KW
Using (A2), we can get

0
 0

∂
∂A 

=  −∂x
 ∂
∂λ
−

∂x
0

0
0
∂
−
∂z
∂
−
∂z
0

0
0

0
0

0

0

0

0

0

0


0
0


0


0

0

(A10)

and using (A7) and (A10), we can write the gradient as
follows:
∂ϵ
∂λ

X ∂A
=−
wl (x, t; xs ), w∗ (x, t; xs )
∂λ
s


0
0
0 0 0 
 

û
u

0
0 0 0

* 0

+
 w 
∂
∂
X 
  ŵ 

−
−
0
0
0


=−
 σx x 
 ∂x
∂z
,  σ̂ x x 

 ∂


∂
s
σzz
σ̂ zz 
−
−
0 0 0
 σ

σ̂ x z
∂x
∂z
xz
0
0
0 0 0
X Z  ∂w ∂u 

=
+
σ̂ x x + σ̂ zz dt.
(A11)
∂z
∂x
s
R EFERENCES
[1] V. Vinje, E. Iversen, and H. Gjøystdal, “Traveltime and amplitude
estimation using wavefront construction,” Geophysics, vol. 58, no. 8,
pp. 1157–1166, Aug. 1993.
[2] W. A. Schneider, K. A. Ranzinger, A. H. Balch, and C. Kruse,
“A dynamic programming approach to first arrival traveltime computation in media with arbitrarily distributed velocities,” Geophysics, vol. 57,
no. 1, pp. 39–50, Jan. 1992.
[3] F. Qin, Y. Luo, K. B. Olsen, W. Cai, and G. T. Schuster, “Finitedifference solution of the eikonal equation along expanding wavefronts,”
Geophysics, vol. 57, no. 3, pp. 478–487, Mar. 1992.
[4] P. C. Sava and S. Fomel, “Angle-domain common-image gathers
by wavefield continuation methods,” Geophysics, vol. 68, no. 3,
pp. 1065–1074, 2003.
[5] S. Leung and J. Qian, “An adjoint state method for three-dimensional
transmission traveltime tomography using first-arrivals,” Commun. Math.
Sci., vol. 4, no. 1, pp. 249–266, 2006.
[6] Y. Luo and G. T. Schuster, “Wave-equation traveltime inversion,” Geophysics, vol. 56, no. 5, pp. 645–653, May 1991.
[7] A. Tarantola, “Inversion of seismic reflection data in the acoustic
approximation,” Geophysics, vol. 49, no. 8, pp. 1259–1266, Aug. 1984.
[8] R. G. Pratt and M. H. Worthington, “Inverse theory applied to multisource cross-hole tomography,” Geophys. Prospecting, vol. 38, no. 3,
pp. 287–310, Mar., 1990.
[9] G. T. Schuster, J. Li, K. Lu, A. Metwally, A. AlTheyab, and S. Hanafy,
“Opportunities and pitfalls in surface-wave interpretation,” Interpretation, vol. 5, no. 1, pp. T131–T141, Feb. 2017.
[10] Ö. Yilmaz et al., “A reality check on full-wave inversion applied to land
seismic data for near-surface modeling,” Lead. Edge, vol. 41, no. 1,
pp. 40–46, Jan. 2022.
[11] Y. Ma and D. Hale, “Wave-equation reflection traveltime inversion with
dynamic warping and full-waveform inversion,” Geophysics, vol. 78,
no. 6, pp. R223–R233, Nov. 2013.
[12] Y. Luo, Y. Ma, Y. Wu, H. Liu, and L. Cao, “Full-traveltime inversion,”
Geophysics, vol. 81, no. 5, pp. R261–R274, Sep. 2016.

ZHANG et al.: AUTOENCODED ELASTIC WT INVERSION

[13] J. M. Zhang, L. G. Dong, and J. H. Wang, “First-arrival multiinformation joint inversion method based on wave-equation,” Chin.
J. Geophys.-Chin. Ed., vol. 64, no. 7, pp. 2447–2460, Jul., 2021.
[14] J. Wang, J. Yang, L. Dong, and Y. Liu, “Frequency-domain waveequation traveltime inversion with a monofrequency component,” Geophysics, vol. 86, no. 6, pp. R913–R926, Nov. 2021.
[15] H. Yu, Y. Chen, S. M. Hanafy, and G. T. Schuster, “Skeletonized waveequation refraction inversion with autoencoded waveforms,” IEEE Trans.
Geosci. Remote Sens., vol. 59, no. 10, pp. 8210–8227, Oct. 2021.
[16] Y. Chen and G. T. Schuster, “Seismic inversion by Newtonian machine
learning,” Geophysics, vol. 85, no. 4, pp. WA185–WA200, Jul. 2020.
[17] A. Dhara and M. K. Sen, “Physics-guided deep autoencoder to overcome
the need for a starting model in full-waveform inversion,” Lead. Edge,
vol. 41, no. 6, pp. 375–381, Jun. 2022.
[18] D. E. Rumelhart, G. E. Hinton, and R. J. Williams, “Learning representations by back-propagating errors,” Nature, vol. 323, no. 6088,
pp. 533–536, Oct. 1986.
[19] D. P. Kingma and M. Welling, “Auto-encoding variational Bayes,” 2013,
arXiv:1312.6114.
[20] W. Luo, J. Yang, W. Xu, and T. Fu, “Locality-constrained sparse autoencoder for image classification,” IEEE Signal Process. Lett., vol. 22,
no. 8, pp. 1070–1073, Aug. 2015.
[21] W. Liu, T. Ma, Q. Xie, D. Tao, and J. Cheng, “LMAE: A large margin
auto-encoders for classification,” Signal Process., vol. 141, pp. 137–143,
Dec. 2017.
[22] V. Nair and G. Hinton, “Rectified linear units improve restricted
Boltzmann machines,” in Proc. 27th Int. Conf. Mach. Learn., 2010,
pp. 807–814.
[23] Y. Chen and E. Saygin, “Seismic inversion by hybrid machine learning,” J. Geophys. Res., Solid Earth, vol. 126, no. 9, Sep. 2021,
Art. no. e2020JB021589, doi: 10.1029/2020JB021589.
[24] K. Lu, J. Li, B. Guo, L. Fu, and G. Schuster, “Tutorial for waveequation inversion of skeletonized data,” Interpretation, vol. 5, no. 3,
pp. SO1–SO10, Aug. 2017.
[25] J. Li, G. Dutta, and G. Schuster, “Wave-equation Qs inversion of skeletonized surface waves,” Geophys. J. Int., vol. 209, no. 2, pp. 979–991,
Feb. 2017.
[26] J. Li, Z. Feng, and G. Schuster, “Wave-equation dispersion inversion,”
Geophys. J. Int., vol. 208, no. 3, pp. 1567–1578, Mar. 2017.
[27] R.-E. Plessix, “A review of the adjoint-state method for computing the
gradient of a functional with geophysical applications,” Geophys. J. Int.,
vol. 167, no. 2, pp. 495–503, Nov. 2006.
[28] D. P. Kingma and J. Ba, “Adam: A method for stochastic optimization,”
2014, arXiv:1412.6980.
[29] J. Schuster, “Twenty five years of least squares migration: Current
developments and its future,” in Proc. SEG Tech. Program Expanded
Abstr., 2018, p. 5443.
[30] J. Nocedal and S. J. Wright, Numerical Optimization. Jul. 2006.
[31] G. H. F. Gardner, L. W. Gardner, and A. R. Gregory, “Formation velocity
and density—The diagnostic basics for stratigraphic traps,” Geophysics,
vol. 39, no. 6, pp. 770–780, Jun. 1974.
[32] S. M. Hanafy, A. AlTheyab, and G. T. Schuster, “Controlled noise
seismology,” in Proc. SEG Tech. Program Expanded Abstr., 2015,
pp. 5102–5106.

Chang Zhang received the B.E. degree in geoexploration from Jilin University, Changchun, China,
in 2020, where she is currently pursuing the master’s
degree.
Her research interests include near surface geophysics method and application and the seismic
waveform inversion.

5904313

Jing Li (Member, IEEE) received the master’s
and Ph.D. degrees in applied geophysics from Jilin
University, Changchun, China, in 2011 and 2014,
respectively.
He was a Visiting Researcher with Delaware State
University, Dover, DE, USA, from 2012 to 2014.
He is a Post-Doctoral Fellow with CSIM Group,
KAUST, Thuwal, Saudi Arabia, where he focuses
on seismic surface wave inversion and data processing. He is a Professor with the College of
Geo-Exploration Science and Technology, Jilin University. His research focused on the advance math method in geophysics application. His research interests include seismic interferometry for subsurface
monitoring and ground-penetrating radar data (GPR) simulation and inversion
for shallow subsurface and through-wall radar and lunar radar detection.

Han Yu received the Ph.D. degree in mathematics from the University of Wyoming, Laramie,
WY, USA, in 2011, under the supervision of
Craig C. Douglas.
He was a Post-Doctoral Fellow with the Division
of Physical Science and Engineering, King Abdullah
University of Science and Technology (KAUST),
Thuwal, Saudi Arabia, from 2012 to 2014. He was
a Semiprofessional Swimmer in high school. He is
also an Associate Professor with the School of
Computer Science, Nanjing University of Posts and
Telecommunications, Nanjing, China, and an Algorithm Consultant with
Suzhou Keda Technology Company Ltd., Suzhou, China. His research interests include waveform inversion, numerical analysis, machine learning, and
information security.
Dr. Yu is a member of the Society of Exploration Geophysicists (SEG), the
IEEE Computer Society (IEEE CS), the China Computer Federation (CCF),
and the China Society for Industrial and Applied Mathematics (CSIAM).

Bin Liu received the B.S. and Ph.D. degrees in civil
engineering from Shandong University, Jinan, China,
in 2005 and 2010, respectively.
He then joined the Geotechnical and Structural
Engineering Research Center, Shandong University,
where he is a Professor with the School of Qilu
Transportation. His research area is engineering geophysical prospecting techniques and especially their
applications in tunnels.
Dr. Liu is a member of the Society of Exploration
Geophysicists (SEG) and the International Society
for Rock Mechanics and Rock Engineering (ISRM). He serves as a Council
Member for the Chinese Geophysical Society.

