Journal of Physics: Conference
Series

You may also like

PAPER • OPEN ACCESS

Seismic waveform inversion using a neural
network-based forward

- An optimized scheme of dispersion
suppression for elastic-wave variableorder rotated staggered-grid forward
modeling
Weizhong Wang, Tianyue Hu, Jianyong
Song et al.

To cite this article: Hongsun Fu et al 2019 J. Phys.: Conf. Ser. 1324 012043

- Multi-component Gaussian beam prestack
depth migration
Jianguang Han, Yun Wang and Jun Lu

View the article online for updates and enhancements.

- Attenuation (1/Q) estimation in reflection
seismic records
Wasiu Raji and Andreas Rietbrock

This content was downloaded from IP address 200.12.181.232 on 24/08/2024 at 17:29

The Second International Conference on Physics, Mathematics and Statistics
IOP Publishing
IOP Conf. Series: Journal of Physics: Conf. Series 1324 (2019) 012043 doi:10.1088/1742-6596/1324/1/012043

Seismic waveform inversion using a neural network-based
forward
Hongsun Fu, Yan Zhang1 and Mingyue Ma
School of Science, Dalian Maritime University, Dalian 116026, China
1

Email: zhangyan_@dlmu.edu.cn

Abstract. The purpose of seismic waveform inversion is to obtain a geological model that is
optimally fitted to the predicted seismic record and the measured seismic record. Since the
forward model is repeatedly called during the inversion process, in order to improve efficiency,
an efficient forward calculation method must be employed. In this study, we take a 2D wave
equation as an example and propose a deep learning method as a forward model to minimize
the prediction error value of seismic records. And the velocity inversion test of the Marmousi
model is carried out by conjugate gradient method. Numerical experiments show that
compared with the traditional finite difference method, the method can greatly reduce the
calculation amount and improve the calculation efficiency.

1. Introduction
Seismic wave forward modeling is an important basis for seismic exploration. It is widely used in
seismic exploration and natural seismic research. By seismic forward modeling, we can check the
rationality of design, and the reliability of the results of processing and interpretation, and the validity
of inversion method and results. The regularity of the forward modeling in a given geological model
can enhance people's understanding of the unknown model and thus contribute to the solution of
geological problems. Generally, the forward modeling of seismic waves can be formulated as an
operator equation
d  g ( m)
(1)
where d is the seismic data vector, g is the forward operator, and m is the model parameter.
The main research methods of seismic wave field forward modeling are divided into ray tracing
method and wave equation method [1, 2]. And the wave equation plays an important role in the
propagation principle of seismic waves and the interpretation of complex formations [3, 4]. There are
many ways to solve the wave equation [5, 6, 7], including finite difference method and finite element
method [8-11]. However, the resolution of the finite difference operator is low in the time domain, and
the stability and convergence of the algorithm are affected by the spatial sampling rate and the
temporal sampling rate [12, 13]. The finite element method requires high memory and a large amount
of computation of the computer, and different boundary conditions need to be set according to
different situations. Therefore, we propose using neural network-based forward to replace the
traditional finite difference method for seismic forward modeling.
Deep learning is a new field of machine learning that has drawn widespread interests by showing
outstanding performances for recognition and classification in image and speech processing [14-17].
The forward problems in equation (1) describe a mapping between, which is usually, one set of
continuous parameters to another set of continuous parameters [18]. We will refer to these methods in

Content from this work may be used under the terms of the Creative Commons Attribution 3.0 licence. Any further distribution
of this work must maintain attribution to the author(s) and the title of the work, journal citation and DOI.
Published under licence by IOP Publishing Ltd
1

The Second International Conference on Physics, Mathematics and Statistics
IOP Publishing
IOP Conf. Series: Journal of Physics: Conf. Series 1324 (2019) 012043 doi:10.1088/1742-6596/1324/1/012043

general as regression networks, and it can be used to estimate the forward operator g in equation (1).
In the following, it is used to replace a computationally expensive forward problem with a regression
network. The main advantage is that this will allow a very fast evaluation of the forward problem,
making it possible to perform model inversion more efficiently. In addition, we use the adjoint-state
method to compute the gradient of the objective function, hence the FWI workflow is simplified so we
can focus mainly on the forward modeling and the model updating. Finally, the neural network-based
forward model will be compared to using other widely used approximate forward models (based on
finite difference approximations) in formulating. Numerical experiments performed on various data
demonstrate the applicability of our method.
The paper is organized as follows. Section 2 gives a brief introduction to the basic inversion
problem, and the concept of seismic forward modeling. The main methods of this paper are introduced
in Section 3, including mathematical framework of using neural networks, preparation of training data
sets, and forward modeling results based on a simple geological models. Section 4 shows the inversion
results of numerical experiments on complex the Marmousi models using neural network forward
modeling. Finally, the conclusion and future work are outlined in Section 5.
2. 2D acoustic-wave equation
For a 2D velocity-depth model, the acoustic-wave equation is expressed as
2
 2u
 2u
2  u
 v ( 2  2 )  s (t )
t 2
x
z

(2)

where v( x, z ) is the velocity of the longitudinal wave at the point ( x, z ) , u is the wave field
describing the velocity bit or pressure, and s(t ) is the source functions.
Indispensable conditions required for seismic forward modeling include seismic source functions,
formation velocity (wave velocity), and boundary conditions. In order to highlight theoretical values in
the model, this paper assumes that all noise, wave conversion, absorption, and diffraction are not
considered. During the iterative forward modeling procedure, we use a perfectly matched layer (PML)
absorbing boundary condition [19], the Ricker wavelet as the seismic source function
2 2

s(t )  e ( 2 f/ ) t cos 2 ft

(3)

where t is the time and f is the center frequency, generally taken as 20-40Hz. In this paper, 20Hz is
taken, r is the parameter of the control band width, and it is choose to be 4.
3. Train data using neural networks
In this section, we first describe the mathematical framework of our novel method using neural
network-based forward modeling. Then, we introduce the data preparation using a simple model and
the forward implementation of the model.
3.1. Mathematical framework based on neural network model
An expected result of forward modeling is to minimize the simulation data records generated by the
network and the actual data records. We define the cost function as the sum of the squares of the
seismic record errors

E

1 N
 ( xk  d k ) 2
2 k 1

(4)

where xk is the corresponding data computed using the exact, but expensive, forward model based on
finite-difference modeling, and d k is the simulated seismic data record.
As discussed, many types of machine-learning regression algorithms exist that can be used to
obtain forward modeling data. In this study, we use a simple two layer feed-forward neural network,

2

The Second International Conference on Physics, Mathematics and Statistics
IOP Publishing
IOP Conf. Series: Journal of Physics: Conf. Series 1324 (2019) 012043 doi:10.1088/1742-6596/1324/1/012043

that is, with one hidden layer, is considered to replace the accurate forward model [20]. Such a neural
network that can be formulated as
NH

NM

j

i

d k  h1 (   jk 2 h2 (   jk 1 xi ))

(5)

where NM  1000 is the number of model parameters and NH is the number of hidden units. In this
case, NH  80 hidden units are considered, h1 and h 2 refer to two activation functions, in this case
both chosen to be of tanh type.  jk and  jk refer to the weights of the units in the first and second
layers. The main reason a two-layer feed-forward network is considered, is that the universal
approximation theorem [21], which states that a feed-forward network with a single hidden layer
containing a finite number of neurons can approximate any continuous function on compact subsets,
under mild assumption on the activation function.
In actual training, we take the seismic wavelet as an input and repeatedly correct its weight such
that the neural network will be able to estimate the data d given a specific model m in an optimal
way. This is achieved by training the neural network based on the training data set, which we usually
consider as an optimization problem, traditionally solved using the backpropagation algorithm.
The network learns by solving the optimization problem as
1

2

ˆ  arg min

1 N
( xi  H ( xi ,  ))2

N i 1

(6)

where H ( xi ,  ) operator is implemented by using the neural network described above.
A commonly used minimization method is the gradient descent method to iteratively update the
parameter vector as follows

t 1  t  

LE


(7)

where  is the positive learning rate.
The neural network algorithm based on forward modeling is as follows:
Initialize the weight  jk1 and  jk 2 , select the learning rate  , determine the error precision and the
maximum number of iterations, and let i  1 ;
Input training sample pairs and calculate the output d k according to equation (5);
Calculate the network output error according to equation (4). When the total network error is less
than the error precision a within the maximum number of iterations, the algorithm converges to exit
the training, otherwise it goes to step 4;
The backpropagation method. Adjust the weight of each layer according to equation (7), let
i  i  1, turn to step3.
3.2. Forward implementation
In order to reflect the application effect of neural network based forward model, we simulated the
forward results of a simple geological model. In this paper, a three-layer horizontal layered
homogeneous medium model is used. Based on the actual geological structure and the velocity data of
various rocks, we determined the velocity and depth parameters of the three layers of horizontal
layered uniformity. The seismic forward waveform records of the model are obtained under the
condition that the seismic simulation records parameters are unchanged. Table 1 shows the structure
and parameters of the geological model.

3

The Second International Conference on Physics, Mathematics and Statistics
IOP Publishing
IOP Conf. Series: Journal of Physics: Conf. Series 1324 (2019) 012043 doi:10.1088/1742-6596/1324/1/012043

Table 1. Model construction and parameters.
Velocity(m/s)
1500
2000
2500

Depth(m)
1000
1200
1400

Combined with the geological model, based on the MATLAB program, the seismic forward record
using a neural network is obtained as shown in Figure 1. Figure 2 is an error curve of actual seismic
records and simulated seismic records. Figure 2 shows use of the neural network-based forward model
results in a modeling error bias is very close to zero, this is because the optimization of the neural
network minimizes the mean square error. It shows that the neural network-based forward model has
achieved good results.

Figure 1. The seismic forward waveform
record of the geological.

Figure 2. Error curve of actual seismic
records and simulated seismic records.

4. Inversion results based on Marmousi model
In order to verify the effectiveness of the proposed method, we applied the conjugate gradient method
to the full-waveform inversion of the time domain acoustic wave and tested it using the Marmousi
model (the Marmousi original model was created by the French Petroleum Institute in 1988 and is
often used to test the correctness and rationality of advanced geophysical imaging methods). In time
domain forward modeling, Ricker wavelet is used as source function, PML is used as absorbing
boundary condition, and neural network-based forward is used to synthesize seismic data sets.
For each velocity model, we use horizontal and vertical spacing of 5 m , a total of 60 shots, shots
are equally spaced on the interface of z  50m , 180 detectors are equally spaced surface. The velocity
obtained by smoothing the real the Marmousi model at large scale is used as the initial guess. The
inversion frequency is in uniform step from the minimum frequency of 5 Hz to the maximum
frequency of 20Hz. A total of 12 frequencies participate in the inversion.
The inversion results of the Marmousi model are shown in Figure 3. Figures 3(a) and 3(b) are true
and initial velocity models respectively. Figure 3(c) shows the results of the inversion velocity using
the neural network for forward modeling. The results show that the inversion results reconstruct the
general features of the model, and the boundaries part of the model is resolved reasonably well. It is
shown that the neural network based on the forward model also has a good inversion result.
In order to test the effect of using neural network-based forward model in this paper, Table 2 lists
the consumption time for forward modeling seismic records between neural network method and finite
difference method, and shows the neural network-based forward has faster convergence velocity and
less time consuming than the finite difference method.

4

The Second International Conference on Physics, Mathematics and Statistics
IOP Publishing
IOP Conf. Series: Journal of Physics: Conf. Series 1324 (2019) 012043 doi:10.1088/1742-6596/1324/1/012043

Table 2. Comparison on time consuming.
Method

Time consuming

Number of iterations

Average time spent

Finite difference

6933.8 s

643

10.78 s

Neural network

4832.4 s

482

10.03 s

(a)

(b)

(c)

Figure 3. Inversion result of Marmousi model. (a) true velocity model, (b) initial velocity model, (c)
inversion model of the proposed method.
5. Conclusions
In this paper, we starting from the time domain wave equation, the error squared sum of the wave field
is taken as the objective function, and the minimum value is solved by using a neural network-based
forward model. A new velocity model construction is demonstrated using neural network that allows
the use of neural network forward modeling instead of computational complex forward modeling.

5

The Second International Conference on Physics, Mathematics and Statistics
IOP Publishing
IOP Conf. Series: Journal of Physics: Conf. Series 1324 (2019) 012043 doi:10.1088/1742-6596/1324/1/012043

Under the premise of ensuring the same imaging results, the calculation amount is significantly
reduced, and the calculation efficiency is improved. However, due to the limited number of training
samples and oversimplied synthetic models and data, future work will focus on the improvements to
the DL-based neural networks that will be applied for precise velocity model building with real
seismic data.
Acknowledgments
This work is partially supported by the National Natural Science Foundation of China (Grant Nos.
41474102, 41304092).
References
[1] Chapman C H 1985 Ray theory and its extensions: WKBJ and Maslov seismograms Geophysics
27-43
[2] Cerveny V 2001 Seismic Ray Theory Cambridge University Press Cambridge UK
[3] Zhang Y G 2003 Numerical simulation of seismic wave field Geophysics 42(2) 143-148
[4] Cao X L, Li Z, Tian C K, Huang J P and Yang Y 2014 Forward modeling of P-and S-wave
separation in viscoelastic media 76th EAGE Conference and Exhibition
[5] Komatitsch D, Barnes C and Tromp J 2000 Wave propagation near a fluid-solid interface: a
spectral-element approach Geophysics 65(2) 623-631
[6] Li N, Li Z C, Huang J P, Guo Z, Tian K and Li Q 2014 Numerical simulation with coupling
lebedev and standard staggered grid schemes for complex anisotropic media Oil Geophysical
Prospecting 49 (1) 121-131
[7] Witten B and Shragge J 2018 Wave equation imaging and adjoint-state inversion for microseismic monitoring Preview
[8] Bernth H and Chapman C 2011 A comparison of the dispersion relations for anisotropic
elastodynamic finite-difference grids Geophysics 76(3) 43-50
[9] Zhang W and Chen X 2006 Traction image method for irregular free surface boundaries in
finite difference seismic wave simulation Geophysical Journal of the Royal Astronomical
Society 167(1) 337-353
[10] Meng W and Fu L Y 2017 Seismic wavefield simulation by a modified finite element method
with a perfectly matched layer absorbing boundary Journal of Geophysics and Engineering
14(4) 852-864
[11] Liu S, Li X, Wang W and Liu Y 2014 A mixed-grid finite element method with pml absorbing
boundary conditions for seismic wave modelling Journal of Geophysics and Engineering
11(5) 055009
[12] Zhu Q, Jiang L and Zhang W 2018 Effects of media discretization method on finite difference
simulation for seismic wave field physical Prospecting for Petroleum 57(2) 198-207
[13] Huang J P, Liao W Y and Li C H 2018 A multi-block finite difference method for seismic wave
equation in auxiliary coordinate system with irregular fluid-solid interface Engineering
Computations 35(1) 334-362
[14] Goodfellow I, Y Bengio and A Courville 2016 Deep Learning MIT Press
[15] LeCun Y, Bengio Y and Hinton G 2015 Deep learning Nature 521 436-444
[16] LeCun Y, Kavukcuoglu K, and Farabet C 2010 Convolutional networks and applications in
vision: Circuits and Systems (ISCAS) Proceedings of 2010 IEEE International Symposium
on Circuits and Systems IEEE 253-256
[17] Krasnopolsky V M and Schiller H 2003 Some neural network applications in environmental
sciences. Part I: Forward and inverse problems in geophysical remote measurements Neural
Netw 16(3) 321-334
[18] Richardson A 2018 Seismic full-waveform inversion using deep learning tools and techniques
Geophysics

6

The Second International Conference on Physics, Mathematics and Statistics
IOP Publishing
IOP Conf. Series: Journal of Physics: Conf. Series 1324 (2019) 012043 doi:10.1088/1742-6596/1324/1/012043

[19] Komatitsch D and Tromp J 2003 A perfectly matched layer absorbing boundary condition for
the second-order seismic wave equation Geophysics 154 146-153
[20] Hansen T M and Cordua K S 2017 Efficient Monte Carlo sampling of inverse problems using a
neural network-based forward-applied to GPR crosshole traveltime inversion Geophysics
211 1524-1533
[21] Csaji B 2001 Approximation with artificial neural networks Faculty of Sciences Etvs Lornd
University 24-48

7

