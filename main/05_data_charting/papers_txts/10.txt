Multiple-Input Fourier Neural Operator (MIFNO) for
source-dependent 3D elastodynamics
Fanny Lehmanna,b , Filippo Gattib , Didier Clouteaub
a

arXiv:2404.10115v1 [cs.LG] 15 Apr 2024

b

CEA, DAM, DIF, , Arpajon, F-91297, , France
LMPS-Laboratoire de Mécanique Paris-Saclay, Université Paris-Saclay, ENS Paris-Saclay,
CentraleSupélec, CNRS, , Gif-sur-Yvette, 91190, , France

Abstract
Numerical simulations are essential tools to evaluate the solution of the wave equation in
complex settings, such as three-dimensional (3D) domains with heterogeneous properties.
However, their application is limited by high computational costs and existing surrogate
models lack the flexibility of numerical solvers.
This work introduces the Multiple-Input Fourier Neural Operator (MIFNO) to deal with
structured 3D fields representing material properties as well as vectors describing the source
characteristics. The MIFNO is applied to the problem of elastic wave propagation in the
Earth’s crust. It is trained on the HEMEWS -3D database containing 30 000 earthquake simulations in different heterogeneous domains with random source positions and orientations.
Outputs are time- and space-dependent surface wavefields.
The MIFNO predictions are assessed as good to excellent based on Goodness-Of-Fit
(GOF) criteria. Wave arrival times and wave fronts’ propagation are very accurate since 80 %
of the predictions have an excellent phase GOF (larger than 8). The fluctuations amplitudes
are good for 87 % of the predictions (envelope GOF larger than 6) and excellent for 28 %.
The envelope score is hindered by the small-scale fluctuations that are challenging to capture
due to the spectral bias inherent to neural networks and the complex physical phenomena
associated with high-frequency features. Nevertheless, the MIFNO can generalize to sources
located outside the training domain and it shows good generalization ability to a real complex
overthrust geology. When focusing on a region of interest, transfer learning is an efficient
approach to improve the accuracy with limited additional costs, since GOF scores improved
by more than 1 GOF unit with only 500 additional specific samples.
The MIFNO is the first surrogate model offering the flexibility of an earthquake simulator
with varying sources and material properties. Its good accuracy and massive speed-up offer
new perspectives to replace numerical simulations in many-query problems.
1. Introduction
Predicting the intensity of ground motion is a crucial challenge for earthquake early warning and seismic hazard analyses. For early warning, one should be able to estimate ground
motion before seismic waves reach the area distant from the epicenter (Allen and Melgar,
April 17, 2024

2019; Cremen and Galasso, 2020); and seismic hazard analyses require repeated evaluations
of ground motion in varying configurations (Baker, 2013). Therefore, fast estimations of
ground shaking intensity are key for both tasks. To this end, recorded seismograms as well
as numerical simulations have been used since they provide complimentary information.
On the one hand, seismograms recorded at different stations for the same earthquake provide means to predict the relationship between earthquake parameters and ground motion
intensity. This type of analysis relies on the existence of earthquake catalogs that are scrutinised with machine learning. Mousavi and Beroza (2023) reviews machine learning methods
such as random forests, support vector machines, artificial neural networks, etc. that have
been used to design non-parametric ground motion models. The development of deep learning is also leading to early warning models able to predict ground motion intensity from
the first seconds of seismograms recorded close to the epicenter, using Convolutional Neural
Networks (CNN, Hsu and Huang (2021); Jozinović et al. (2020)), Graph Neural Networks
(GNN, Bloemheuvel et al. (2023)), or Recurrent Neural Networks (RNN, Datta et al. (2022);
Wang et al. (2023)). One main limitation in these approaches is their need for a large number
of recordings in the area under study. In regions with poor data coverage or low-to-moderate
seismicity, these purely data-driven methods fall short.
On the other hand, numerical simulations provide ground motion timeseries in any seismological context. They allow a great flexibility since parameters describing geological properties, source characteristics, stations location, etc. can be specified on demand. Physics-based
simulations should be conducted in three-dimensional (3D) domains to correctly model the
propagation of waves beyond the too simplistic two-dimensional (2D) setting (Moczo et al.,
2018; Smerzini et al., 2011; Zhu et al., 2020). In the meantime, numerical results should be
accurate up to frequencies of a few Hz to allow meaningful engineering applications (Bradley
et al., 2017). Independently from the numerical method used to solve the wave equation (e.g.
finite differences, finite elements, spectral elements, among others), these constraints lead to
high computational costs that can become a limiting factor when quantifying uncertainties.
Indeed, the computed ground motion strongly depends on the simulation parameters, such
as the regional geological properties and the source characteristics. Due to the difficulty of
conducting geophysical measurements and accurately inverting the source properties, these
parameters are associated with large uncertainties. Therefore, with a Monte-Carlo approach,
many simulations should be conducted to assess the influence of parameters uncertainties on
ground motion response. The computational cost of high-fidelity simulations prohibits this
approach.
With the joint development of high-performance computing and deep learning, there is
a growing interest in developing surrogate models able to mimic numerical simulations. The
aim is to predict space-dependent ground motion timeseries that give much more detailed
information than ground motion models restricted to some intensity measures. Thus, neural
operators (Li et al., 2021; Lu et al., 2021; Brandstetter et al., 2022) are a suitable framework to
provide solutions of the wave propagation equation from a set of input parameters describing
the geological configuration (velocity of P and S waves, soil density, attenuation factors) and
the source (epicenter location, source orientation, magnitude).
Neural operators were shown to be efficient surrogate models for the elastic wave equation
2

in 2D (O’Brien et al., 2023; Yang et al., 2023; Zhang et al., 2023) and 3D (Kong and Rodgers,
2023; Lehmann et al., 2023, 2024a; Zou et al., 2023). These works use variants of the Fourier
Neural Operator (Li et al., 2021) to learn the propagation of seismic waves by the means
of their frequency representation. Some studies consider both the source location and the
geological parameters as input variables (Kong and Rodgers, 2023; O’Brien et al., 2023; Yang
et al., 2023; Zou et al., 2023). Yet, these works do not take into account the different nature
of the geological and source parameters: a structured 2D or 3D field for the geology and a
vector of coordinates for the source. The source position is encoded as a binary field where
a single pixel of value 1 describes the source location.
In addition, an earthquake source cannot be described solely by the source location since
its orientation also plays a crucial role, through the definition of the moment tensor. With
the notable exception of O’Brien et al. (2023) that restricts their analyses to 2D and mention
"significant challenges" to extend their methodology to 3D, the above-mentioned works consider an isotropic explosive source. In this situation, the moment tensor is fixed and does not
need to be learnt by the surrogate model. But it prevents earthquake modeling that requires
a moment tensor description of the source. The current study proposes an alternative architecture to include both the source location and moment tensor by considering their vector
representation.
Some neural operators have been designed specifically to account for multiple inputs,
possibly with different structures. The General Neural Operator Transformer (GNOT, Hao
et al. (2023)) uses different Multi-Layer Perceptron (MLP) blocks to encode each input before
transmitting it to a transformer network. Other models were inspired by the Deep Operator
Network (DeepONet, Lu et al. (2021)) by implementing one specific branch network for
each input (MIONet, Jin et al. (2022), Fourier-MIONet (Jiang et al., 2023)). However, the
complexity of these models makes 3D applications challenging.
In this study, we propose a Multiple Input Fourier Neural Operator (MIFNO) that takes
as inputs the 3D geological properties, the source position and the source orientation, and
predicts the surface ground motion as the solution of the 3D elastic wave equation. The
inherent complexity of 3D variables is handled with a Factorized Fourier Neural Operator
(F-FNO, Tran et al. (2023)). The MIFNO involves a convolutional branch transforming
information from the source into structured fields that get through the factorized Fourier
layers. The MIFNO is trained on the HEMEWS -3D database containing 30 000 simulations
of elastic wave propagation in 3D heterogeneous geologies with randomly located and oriented
sources.
In the following, Section 2 describes the data and the neural operators used for training.
Section 3 analyses the predictions, discusses the evaluation metrics, and the influence of
inputs on the outcomes. Section 4 explores generalization to out-of-distribution data and
Section 5 extends it with transfer learning to a real earthquake. Finally, Section 6 draws
conclusions.

3

2. Data and methods
2.1. Problem setting
We consider a cubic domain Ω = [0; Λ] ⊂ R3 of size 9.6 km × 9.6 km × 9.6 km. Seismic
waves propagate inside this domain from the source up to the upper surface denoted ∂Ωtop .
Except the traction-free upper surface ∂Ωtop , all other external surfaces have absorbing conditions to mimic a semi-infinite propagation domain.
The propagation domain is described by geological parameters (velocity of P and S waves,
soil density, attenuation factors). For the sake of simplicity, we assume that the geology is
entirely defined by the S-wave velocity VS and other parameters can be computed from
deterministic relationships involving only VS (in particular, the ratio VP /VS is fixed to 1.7).
In the general setting, the propagation domain is characterized by a function a : Ω → R that
gives the value of VS at each spatial point x ∈ Ω.
The propagation of waves inside the domain obeys the elastic wave equation
ρ

h
i
∂ 2u
T
=
∇λ
(∇
·
u)
+
∇µ
∇u
+
(∇u)
+ (λ + 2µ) ∇ (∇ · u) − µ∇ × ∇ × u + f
∂t2

(1)

where ρ : Ω → R is the material unit mass density, λ : Ω → R, µ : Ω → R are the
Lamé parameters (all contained in our general function a), characterizing the thermodynamically reversible mechanical behaviour of the material, f is the body force distribution, and
u : Ω × [0, T ] → R3 is the displacement field. The forcing term f (x, t) = div m(x) · s(t)
is the divergence of a moment tensor density m, localized at a point-wise location xs . In
this study, the moment tensor is given as a vector θs and the source position is denoted by
the vector xs . Then, equation 1 can be rewritten under the general form
L(a, u) = f (xs , θs )

(2)

We aim at a surrogate model Gϕ (a, xs , θs ) predicting the velocity field u̇ (obtained as the
time derivative of the displacement u) from the sole knowledge of the geology a and the source
characteristics xs , θs . Reference velocity fields are obtained with physics-based numerical
simulations. To reduce the memory requirements, simulation outputs are synthetized only
at the surface of the propagation domain ∂Ωtop . For the sake of clarity, u denotes surface
velocity fields u̇|∂Ωtop in the following. The surrogate model is trained to minimize the error
between the predicted surface velocity fields û and the simulated ones u.
2.2. Data
Each data sample is composed of four elements: the description a of S-wave velocity inside
Ω, the source position xs , the source orientation θs , and the simulated surface velocity field
u.
S-wave velocity models are designed as random horizontal models augmented with random
heterogeneities. The horizontal models are built as a stack of horizontal layers with random
thickness and random value. They describe the baseline geophysical knowledge of the domain.
Then, log-normal random fluctuations are added independently inside each layer to represent
4

Figure 1: Composition of the HEMEWS -3D database. Velocity models were built from
the addition of randomly chosen horizontal layers and heterogeneities drawn from random
fields. Combined with the source position and the source orientation, they form the inputs of
the neural operator. Outputs of the Spectral Element Code SEM3D are velocity wavefields
synthetized at the surface of the domain by a grid of virtual sensors.
geological heterogeneities (Fig. 1). These random fields are stationary and characterized
by their coefficient of variation σ following a folded normal distribution |N (0.1, 0.2)|, their
correlation length ℓc randomly chosen in {1.5, 3, 4.5, 6 km}, and their power spectral density
or correlation function. After the addition of random heterogeneities, S-wave velocities are
clipped between VS,min = 1071 m/s and VS,max = 4500 m/s. Table 1 summarizes the velocity
models parameters and a more detailed description of the velocity models can be found
in (Lehmann et al., 2024b). More advanced random fields could be defined for practical
applications accounting for VP , VS , ρ variability together with controlled anisotropy (Ta
et al., 2010). However, it is believed that the proposed model spreads a large enough set
to demonstrate the applicability of our surrogate model to other probabilistic models of the
geological formation.
The source position xs = (xs , ys , zs ) is chosen from a Latin Hypercube sampling inside
the propagation domain, not too close from the boundaries to avoid numerical issues due to
absorbing boundary conditions:
xs ∈ [1.2; 8.4 km]
ys ∈ [1.2; 8.4 km]
zs ∈ [−9.0; −0.6 km]
The moment tensor is a 3 × 3 symmetric matrix that represents the source of a seismic
event. When the seismic event is an earthquake, the moment tensor can be derived from
three angles (strike, dip, and rake) that characterize the seismic rupture. The angles were
sampled from a Latin Hypercube with a strike between 0° and 360°, dip between 0° and
5

Parameter
Number of heterogeneous layers Nℓ
Layers thickness h1 , · · · , hNℓ
Mean VS value per layer
Layer-wise coefficient of variation
Layer-wise correlation length along x
Layer-wise correlation length along y
Layer-wise correlation length along z

Statistical distribution
U({1, 2, 3, 4, 5, 6})
U ({(h1 , · · · , hNℓ ) > 0|h1 + · · · + hNℓ = 7.8 km})
U([1785, 3214 m/s])
|N (0.2, 0.1)|
U({1.5, 3, 4.5, 6 km})
U({1.5, 3, 4.5, 6 km})
U({1.5, 3, 4.5, 6 km})

Table 1: Statistical distribution of each parameter describing the velocity models a. Mean
VS values, coefficients of variation, and correlation lengths are chosen independently in each
layer. Since the bottom layer has a constant thickness of 1.8 km and value VS =4500 m/s, it
is not included in these parameters.
90°, and rake between 0° and 360°. This constitutes the first representation of the source
orientation, θs ∈ R3 . Alternatively, the equivalent moment tensor was computed for each set
of angles. Then, the source orientation is described by the six components of the symmetric
moment tensor θs ∈ R6 . The MIFNO can be trained with any of these representations. The
source amplitude corresponds to a seismic
moment M0 = 2.47 × 1016 N m and the source

t
time evolution is given by t 7→ 1 − 1 + τt e− τ with τ = 0.1 s.
Numerical simulations are conducted with the SEM3D code1 (Touhami et al., 2022) based
on the Spectral Element Method (Faccioli et al., 1997; Komatitsch and Tromp, 1999). The
simulation domain is discretized in elements of size 300 m and 7 Gauss-Lobatto-Legendre
quadrature points per side of mesh element allow the propagation of waves up to a 5 Hz
frequency. Velocity fields u are synthetized on a regular grid of 32 × 32 virtual sensors
located at the surface of the domain. A time window of [0s; 6.4s] is selected as it contains
the significant ground motion and the time sampling is 0.02 s. It should be noted that the
velocity field at each sensor contains three components, denoted as E-W (East-West), N-S
(North-South), and Z (vertical).
It is important to emphasize that velocity fields are seen as 3D variables depending on the
coordinate (x, y) of the surface sensor and time t. Therefore, both the geological parameters
given as inputs (function of (x, y, z)) and the output surface wavefields (function of (x, y, t))
are 3D variables, with a depth-to-time conversion happening in the transformation.
Predicting the space- and time-dependent solution of the 3D elastic wave equation is
a complex high-dimensional problem. The complexity can be assessed with two notions
of intrinsic dimension. The Principal Component Analysis (PCA) dimension describes the
number of linear components required to capture 95 % of the variability in the ground motion
wavefields database. The intrinsic dimension can also be estimated from the Maximum
Likelihood Estimation (MLE) of the size of the wavefields’ neighbourhood Levina and Bickel
1

https://github.com/sem3d/SEM

6

(2004). The intrinsic dimensions is at least of the order of 100 when estimated with the
non-linear MLE and it reaches nearly 5000 with the linear PCA (Fig. S3). Although it is
impossible to conclude on the exact dimensionality of the ground motion wavefields, these
results emphasize the complexity of the problem.
2.3. Factorized Fourier Neural Operator (F-FNO)
The Fourier Neural Operator (FNO) was proposed by Li et al. (2021) to extend neural
networks to functional spaces. It is especially convenient to solve problems related to Partial
Differential Equations (PDEs) since it can be interpreted as a means to learn the frequency
representation of the PDE solution. The FNO is based on Fourier layers that involve computing the Fast Fourier Transform (FFT) of the model internal variables. Although only the
first Fourier modes are preserved to limit the model complexity, the FFT yields a large number of model parameters when dealing with 3D variables. This increases the generalization
gap of the FNO (Lehmann et al., 2024a) and hinders its accuracy.

Figure 2: The F-FNO is made of one uplift block P , a succession of L factorized Fourier
layers, and three projection blocks QE , QN , QZ . The details of a factorized Fourier layer are
given to show the decomposition of the FFT along each dimension.
Therefore, a more efficient approach was introduced with the Factorized Fourier Neural
Operator (F-FNO, Tran et al. (2023)). The general architecture of the F-FNO is similar to
the FNO and is illustrated in Fig. 2. Inputs consist of the concatenation of four 3D variables:
the velocity model a and the grid of x, y, and z coordinates. The concatenation is performed
along the fourth dimension representing the channels. Then, a shallow linear block P uplifts
the 4-channel input variable into a variable v0 with dv channels (dv =16 in this work). P
acts point-wise on the inputs and allows to locate the geological parameters at their exact
location. Then, a succession of L factorized Fourier layers is applied to transform v0 into vL .
7

At the end of the F-FNO, three shallow linear blocks QE , QN , QZ project vL onto each of
the velocity component uE , uN , uZ .
In the F-FNO, the factorized Fourier layers transform the internal variable vℓ into vℓ+1
following
vℓ+1 = vℓ + M LP (Kℓ (vℓ ))

M LP (k) = Wℓ2 σ Wℓ1 k + b1ℓ + b2ℓ

(3)

where σ is the activation function, Wℓ1 and Wℓ2 are bias matrices acting point-wise, b1ℓ and
b2ℓ are scalar biases, and Kℓ is a neural network playing the role of the integral operator.
The majority of the F-FNO weights are contained in the Kℓ network. The core idea of this
network (Li et al., 2021) stems from the convolution theorem that allows one to write an
integral operator K depending on the stationary kernel κψ (where ψ denotes the learnable
weights)
Z
κψ (x, y)v(y)dy

(4)

K(v) = F −1 (Rψ · F(v))

(5)

K(v) =
as the product

In equation 5, F denotes the Fourier transform and Rψ = F(κψ ) is the tensor of learnable
complex weights. In comparison with the original FNO formulation, the kernel Kℓ of the
factorized Fourier layer replaces the 3D Fourier transform F by the sum of three 1D Fourier
transforms along each dimension (F(1) , F(2) , F(3) ):



−1
−1
−1
Kℓ (vℓ ) = F(1)
R(1),ℓ F(1) (vℓ ) + F(2)
R(2),ℓ F(2) (vℓ ) + F(3)
R(3),ℓ F(3) (vℓ )
(6)
In equation 6, R(1),ℓ , R(2),ℓ , and R(3),ℓ are the neural operator’s weights that are optimized
during training. The Fourier transform is computed efficiently with the Fast Fourier Transform (FFT) and only the first Fourier modes are selected in each dimension. In this work,
16 Fourier modes are selected in the x and y dimensions (M(1),ℓ = M(2),ℓ = 16, ∀ℓ) and
32 Fourier are selected in third dimension except for the first layer (M(3),ℓ = 32, ∀ℓ ≥ 2,
M(3),1 = 16).
It should also be noted that inputs and outputs have different dimensions in our work.
Indeed, inputs are velocity models depending on the three spatial variables (x, y, z), their
size is Sx × Sy × Sz . While outputs are time-dependent velocity fields recorded only at the
surface of the propagation domain. Therefore, they depend on the spatial location of the
sensor (x, y) and time t. The size of outputs is then Sx × Sy × St . Dimensions are chosen as
Sx = Sy = Sz = 32 and St = 320. The third dimension increase is done gradually inside the
Fourier layers by padding Fourier coefficients with zeros before applying the inverse Fourier
transform (Rahman et al., 2023). The same procedure is applied before the summation to
match the dimensions (block ModifyDimensions in Fig. 2).
Works like (Kong and Rodgers, 2023; Zou et al., 2023) add the source position as an
additional input to the Neural Operator. This is done by inserting a fifth variable alongside
a and the grids x, y, z. This variable is a cube full of zeros with a single pixel of 1 denoting the
8

source position. In this work, we propose an alternative architecture that takes advantage of
the vector representation of the source to include more source parameters. It is worth noticing
that the elastodynamic problem 1 being linear with respect to the force term f , extended
sources such as an extended seismic fault can be easily addressed using the superposition
principle.
2.4. Multiple-Input Fourier Neural Operator (MIFNO)
Inspired by the MIONet architecture that designs separate branches for each input (Jin
et al., 2022), we propose a Neural Operator architecture that encodes the source parameters
in a specific branch. Our Multiple-Input Fourier Neural Operator (MIFNO) is illustrated in
Fig. 3.

Figure 3: The MIFNO is made of a geology branch that encodes the geology with factorized
Fourier (F-Fourier) layers, and a source branch that transforms the vector of source parameters (xs , θs ) into a 4D variable vS matching the dimensions of the geology branch output vK .
Outputs of each branch are concatenated after elementary mathematical operations and the
remaining factorized Fourier layers are applied. Uplift P and projection QE , QN , QZ blocks
are the same as in the F-FNO.
In our MIFNO, the succession of factorized Fourier layers is split in two parts. From layers
1 to K, factorized Fourier layers act on the geology as in the original F-FNO. This forms the
geology branch. In parallel, the source branch takes as input the vector of source coordinates
xs concatenated with the source characteristics θs . Even though resolution invariance requires additional conditions (Bartolucci et al., 2023), FNOs can always be technically applied
to inputs having a different resolution than the resolution used during training. This property
must be preserved in the source branch, which is not trivial for convolutional layers whose
number of weights depend on the size of the inputs. To circumvent this issue, the layers in
the source branch are defined based on the number of modes used in the K-th factorized
Fourier layer, denoted Mx , My , Mz , and not the actual size of the inputs.
Several architectures were investigated to design the source branch (not shown) and we
found that the best one was made of a perceptron and two convolutional layers separated by
reshaping operations. Our interpretation of the source branch is the following:

9

1. a 2-layer perceptron encodes the source characteristics in the (x, y) plane. Its first layer
contains 128 neurons and its second layer 4Mx My neurons. The reshaping operation
leads to a 3D variable of size 2Mx × 2My × 1.
2. a 2D CNN (with kernel size of 3) creates the third dimension. A first convolutional
layer creates 8 channels and a second layer creates 2Mz channels. After reshaping, one
gets a 4D variable of size 2Mx × 2My × 2Mz × 1.
3. a 3D CNN (kernel size of 3) adds the channel dimension with two convolutional layers.
At the end of the source branch, the ModifyDimensions layer transforms variables into the
Fourier space where Fourier coefficients are padded with 0 if necessary, and then inverse
transformed to obtain the same dimension as the output of the geology branch vK , i.e. Sx ×
S y × S z × dv .
To combine variables from the geology and source branches, we take inspiration from
Haghighat et al. (2024) who propose a 2D eXtended-DeepONet for earthquake localization.
Following this idea, vK and vs are summed, substracted, and multiplied before being concatenated along the channel dimension. This leads to a variable of size Sx × Sy × Sz × 3dv
that is then sent to the remaining factorized Fourier layers, K + 1 to L. The final projection
layers QE , QN , QZ are identical to the F-FNO.
It can also be noted that the MIFNO is exemplified with factorized Fourier layers but
the architecture can be extended to other types of layers. The MIFNO used in this work
contains 16 factorized Fourier layers in total (L = 16), including 4 layers in the geology
branch (K = 4). The number of channels is fixed to dv = 16. Its total number of parameters
amount to 3.40 million. The initial learning rate is 0.0004 and is halved on plateau, and
the loss function is the relative Mean Absolute Error. The choice of hyperparameters and
training strategies comes from extensive investigations conducted for the F-FNO in Lehmann
et al. (2024a). 27 000 samples were used for training and 3000 for validation. Training was
performed on 4 Nvidia A100 GPUs for 200 epochs, which took 29.6 h.
Some care should be taken to normalize the inputs and outputs since their variability
ranges are significantly different. Geological models are normalized to a Gaussian distribution, by centering them with respect to the mean geology and normalizing by four times the
geological standard deviation to yield values approximately in [−0.50.5]. The source coordinates and the source angles are mapped to the [0, 1]3 cube. Velocity wavefields predicted
by the MIFNO are normalized with a scalar (i.e. independent of the sensor coordinates)
that depends only on parameters known beforehand: the S-wave velocity at p
the source location VS (xs ) and the source depth zs . The normalization value is c = Vs (xs ) zs2 + (Λ/4)2
where Λ is the length of the domain. The first term relates to the seismic energy released by
an earthquake, which is inversely proportional to the shear modulus (hence, to the S-wave
velocity) at the rupture location. The second term accounts for the amplitude decrease of
seismic waves generated by deep sources since they undergo more geometrical dispersion and
diffraction.

10

3. Results
When comparing the surrogate model predictions with the reference numerical simulations, one needs to use appropriate metrics that explain the physical meaning of the misfit.
In particular, the usual Mean Absolute Error (MAE) and Root Mean Square Error (RMSE)
have limited interpretability to analyze time series predictions. In seismology, time series are
often compared in terms of time-frequency envelope and phase misfits Kristeková et al. (2009).
Misfits can be summarized by two scalar values: the envelope Goodness-Of-Fit (GOF) and
the phase GOF. The envelope GOF expresses the error of the predicted amplitude compared
to the reference time series while the phase GOF describes the error of the phase arrivals.
GOFs are given on a scale between 0 and 10 where 10 means a perfect agreement and the
following score assessment is well accepted: 0-4 is a poor score, 4-6 is fair, 6-8 is good, 8-10
is excellent Kristeková et al. (2009).
3.1. Predictions analyses
Figure 4 illustrates the MIFNO predictions for a geology in the test dataset (Fig. 4a)
and a source located at (3.9, 2.6, −6.2 km) with a strike of 298.7°, dip of 85.3°, and rake of
15.4°. The time series show an excellent accuracy on the three components since the wave
arrival times are exactly reproduced: P-waves around 1.6 s and S-waves around 2.7 s. The
peaks amplitude is also very similar between the prediction and the simulated ground truth.
The frequency representation confirms the excellent agreement for all frequency ranges (Fig.
4c) and the three components.
At the depicted sensor, the envelope GOF is 8.7 and the phase GOF is 9.5. Since both
scores are excellent, they reflect the visual agreement that can be observed in Fig. 4. The
envelope GOF is slightly lower than the phase GOF due to the presence of small-scale and
small-amplitude fluctuations that are challenging to predict with the MIFNO (visible around
4 s in Fig. 4b).
When looking at the spatial evolution of the predictions, Fig. 5 shows that it is very
accurate for the different time steps. The wavefront propagates from the source (epicenter
denoted with the white star) with the correct speed since the arrival times are correct for
all spatial locations. The source orientation is clearly visible in the first snapshot and it is
correctly reproduced by the MIFNO. It is also remarkable that both P waves and S waves are
well predicted, although their amplitude is very different (maximum East-West amplitude
around 2 cm/s for the P waves and around 20 cm/s for the S waves). One can however notice
that the predictions are smoother after the main wavefront, which reflects that small-scale
fluctuations are under-estimated. This is visible for instance at t=2.00 s in Fig. 5 where the
predicted wavefields show less fluctuations than the simulated ground truth.
3.2. Metrics analyses
To quantify the predictions accuracy more systematically, the envelope and phase GOFs
were computed for samples in the training and validation datasets. Figure 6 shows that the
GOF distributions are very similar for training and validation data. This indicates that the
MIFNO is not subject to overfitting. Although the loss evolution during training shows a
11

(a)

(b)

(c)
Figure 4: (a) Geology in the test dataset corresponding to the predictions in panels (b) and
(c). The source is located at (3.9, 2.6, −6.2 km) with a strike of 298.7°, dip of 85.3°, and rake
of 15.4°. (b) Velocity time series simulated (black) and predicted (dashed red line) in the
three components: East-West (E), North-South (N), Vertical (Z). (c) For the same sensor as
panel (b), amplitude of the Fourier coefficients of the velocity time series.

12

Figure 5: East-West component of the simulated (upper row) and predicted (center row)
velocity fields for the geology illustrated in Fig. 4 at five time instants. The error between
simulation and prediction is given in the lower row. The white star indicates the epicenter.
stable convergence with a small generalization gap (Fig. S1), this does not seem to impact
the prediction accuracy.
The GOFs distributions confirm that the phase accuracy is better than the envelope
accuracy (Fig. 6 and Tab. 2). Indeed, 80.2 % of predictions have an excellent phase GOF
(phase GOF larger than 8). Envelope GOFs are good for 87.3 % of predictions (envelope
GOF larger than 6), and 27.8 % are excellent (envelope GOF larger than 8).
Table 3 indicates that the relative Root Mean Square Error (rRMSE) is 33 % on the
validation dataset (first quartile). The relative RMSE is computed between predicted and
simulated velocity timeseries at each sensor. Errors are then averaged over all sensors and
samples. Relative errors on the order of 30 % are common in 3D PDE predictions, especially
when complexity arises from the presence of heterogeneous parameters.
Due to the limited interpretability of the RMSE, it is complemented by the frequency
13

Figure 6: Distribution of the envelope GOF (left) and phase GOF (right) for each sensor and
1000 samples in the training (grey area) and validation (blue line) datasets.
Model
MIFNO 8 layers
MIFNO 16 layers

Envelope GOF
6.32 ; 7.89
6.57 ; 8.08

Phase GOF
8.07 ; 9.17
8.20 ; 9.21

Table 2: 1st and 3rd quartiles of the GOFs computed on 1000 validation samples. GOFs
range from 0 to 10 where 10 is the best score
biases, computed as the errors between the amplitudes of Fourier coefficients in simulated
u(x, y) and predicted û(x, y) velocity fields. Frequency biases are given for low frequency
(0-1Hz), medium frequency (1-2Hz), and high frequency (2-5Hz) components following
rFFTlow =

F (û(x, y))low − F (u(x, y))low

with
F (u(x, y))low =

F (u(x, y))low
1 X
|F(u(x, y))(f )|
Nf 0≤f <1

(7)

(8)

In equation (8), Nf denotes the number of frequencies f between 0 and 1Hz and F is the
Fourier transform. Definitions naturally extend to medium and high frequencies. It should
be noted that positive frequency biases indicate an overestimation of the frequency content
compared to the reference (F (û(x, y)) ≥ F (u(x, y))) while negative values indicate underestimation. Noting that the mean of Fourier coefficients amplitudes F (u(x, y)) is always
positive, this implies that the frequency biases cannot be lower than −1. This explains the
steep decrease of the high-frequency distribution around −1 in Fig. S2.
14

Model
MIFNO 8 layers
MIFNO 16 layers

rRMSE
0.34 ; 0.59
0.33 ; 0.59

rFFTlow
-0.54 ; -0.09
-0.49 ; -0.05

rFFTmid
-0.63 ; -0.15
-0.57 ; -0.09

rFFThigh
-0.68 ; -0.18
-0.62 ; -0.11

Table 3: 1st and 3rd quartiles of the metrics computed on 1000 validation samples. rRMSE:
relative RMSE (0 is best), rFFTlow : relative frequency bias 0-1Hz (0 is best), rFFTmid :
relative frequency bias 1-2Hz (0 is best), rFFThigh : relative frequency bias 2-5Hz (0 is best).
For frequency biases, negative values indicate underestimation while positive values indicate
overestimation.
Table 3 indicates that the MIFNO mainly underestimates the frequency content of signals
since frequency biases are mostly negative. This can be observed in Fig. 4 where the small
fluctuations at the end of the signal tend to be ignored in the predictions. Previous findings on
the F-FNO for a dataset with a fixed source corroborate these results (Lehmann et al., 2024a).
Also, the MIFNO leads to larger underestimations for high-frequency components (the interquartile range is −62 % ; −11 % for high-frequency components while it reduces to −49 %;
−5 % for low frequencies, Tab. 3). This reflects the well-known spectral bias, which states
that small-scale (i.e. high-frequency) features are more difficult to predict than large-scale
features (Basri et al., 2020; Rahaman et al., 2019). In addition, the small-scale fluctuations
also reflect complex physical phenomena due to the refraction of seismic waves on scatterers.
Indeed, fluctuations are mostly observed in the coda, after the S-wave arrival. Hence, they
originate from the late arrivals of diffracted waves. Late velocity fields are subject to a
large inter-sample variability, both between different sensors and between similar geologies
with different locations of scatterers. These factors make high-frequency predictions very
challenging.
One can also notice that the deeper MIFNO with 16 layers gives better predictions than
the MIFNO with 8 layers (Tab. 2 and 3). Therefore, increasing the complexity of the model
is beneficial to improve its accuracy and does not lead to overfitting. This improvement is not
reflected by the relative RMSE while it is obvious on the other metrics, thereby emphasizing
the need to consider physically-rooted metrics to evaluate the predictions accuracy.
It can also be noted that there is no significant difference between the MIFNO taking
as inputs the three angles describing the source orientation or the corresponding moment
tensor (Tab. S1). Therefore, the MIFNO with angles is used in the following for more direct
interpretations of the results.
3.3. Comparison with baseline models
Due to the difficulty of finding existing implementations of models for 3D and vector
inputs, the MIFNO is compared to F-FNO models with less flexibility. This is meant to
ensure that the additional complexity induced by the source branch does not deteriorate
the predictions. To do so, we use three different databases that contain the same geological
models but different surface velocity wavefields depending on the source parametrization:

15

1. in the HEMEW-3D database, both the source position and orientation are fixed. The
source is located in the middle of the bottom layer: xs =4.8 km, ys =4.8 km, zs =−8.4 km
and its orientation is fixed to strike=48°, dip=45°, rake=88° (Lehmann et al., 2024a).
This database contains Ntrain =27 000 training, Nval =3000 validation and Ntest =1000
test samples.
2. in an intermediate database, the source is located randomly inside the bottom layer,
i.e. xs ∼ U([1200; 8100 m]), ys ∼ U([1200; 8100 m]), zs ∼ U([−9000; −8100 m]) and
its orientation is fixed to the same value as the HEMEW-3D database. This database
contains Ntrain =20 000 training, Nval =2000 validation and Ntest =1000 test samples.
3. the HEMEWS -3D database described in Section 2.2 contains sources located randomly
anywhere in the domain and with any source orientation. It contains Ntrain =27 000
training, Nval =3000 validation and Ntest =1000 test samples.
First, let us consider the prediction accuracy with respect to the geological properties.
The baseline model is the 16-layer F-FNO described in Section 2.3. To match the number of
parameters of the MIFNO, the F-FNO was designed with dv =16 channels in layers 1 to 4, and
dv =48 channels in layers 5 to 16. The F-FNO was trained on the first database HEMEW-3D
with fixed source location and orientation. The MIFNO was trained as described above on the
HEMEWS -3D database with random source location and orientation. Therefore, it should
be noted that the training task of the MIFNO is much more complex than the F-FNO’s task.

Figure 7: For 1000 samples in the HEMEW-3D test dataset (fixed position and fixed orientation) and each sensor, the frequency bias of the MIFNO (vertical axis) is shown against the
F-FNO frequency bias (horizontal axis). Each subplot corresponds to a different frequency
bias, 0-1Hz (left), 1-2Hz (middle), 2-5Hz (right). Optimal predictions correspond to a frequency bias of 0.
At inference stage, both the F-FNO and the MIFNO were used to predict surface velocity
wavefields for 1000 test geologies with a fixed source corresponding to the reference source
in the HEMEW-3D database. Figure 7 compares the F-FNO predictions with the MIFNO
predictions for each sensor and each sample. One can firstly notice that points are widespread
on both sides of the diagonal, meaning that the MIFNO or the F-FNO can give better
predictions depending on the situation. However, points are more densely distributed in the
16

lower right triangle of the graph, close to the diagonal (Fig. 7). This indicates that the
F-FNO is in average more accurate than the MIFNO when predicting only solutions with a
fixed source.
However, the difference between the F-FNO and the MIFNO is around 0.8 GOF units,
which remains acceptable knowing the extended complexity of the MIFNO’s task (Tab. S2).
Figure S4 illustrates velocity time series predicted by the F-FNO and the MIFNO. It shows
that the MIFNO predictions are already reasonable while the F-FNO locally improves the
accuracy.
For the next comparison, we focus on the influence of the source location. To do so,
we designed a F-FNO taking as input the geological parameters and a binary encoding of
the source position, i.e. a cube full of zeros with a single 1 indicating the position of the
source. The MIFNO was trained with only the source coordinates given as inputs to the
source branch. In this experiment, both the F-FNO and the MIFNO were trained on the
second database (random source location and fixed orientation).
Model
F-FNO
MIFNO

Dataset with a random source position and fixed source orientation
rRMSE
rFFTlow
rFFTmid
rFFThigh
EG
PG
0.11 ; 0.20 -0.22 ; 0.06 -0.29 ; 0.05 -0.34 ; 0.05 7.49 ; 8.63 8.74 ; 9.42
0.12 ; 0.21 -0.23 ; 0.05 -0.30 ; 0.04 -0.36 ; 0.04 7.36 ; 8.53 8.64 ; 9.36

Table 4: 1st and 3rd quartiles of the metrics computed on 1000 validation samples. rRMSE:
relative RMSE (0 is best), rFFTlow : relative frequency bias 0-1Hz (0 is best), rFFTmid :
relative frequency bias 1-2Hz (0 is best), rFFThigh : relative frequency bias 2-5Hz (0 is best),
EG: envelope GOF (10 is best), PG: phase GOF (10 is best). For frequency biases, negative
values indicate underestimation. Both models contain 16 layers and were trained with 20 000
samples for 300 epochs.
When both models have 8 layers, the MIFNO predictions are slightly better than the
F-FNO (Tab. S3). With 16 layers, both models give a similar accuracy (second digit fluctuations in Tab. 4 are within the variability of the model due to a different random initialization).
Phase GOFs are excellent for both models and the envelope GOFs are close to excellent (Tab.
4). Overall, these results show that the source branch architecture in the MIFNO preserves
the expressivity of the F-FNO while providing the flexibility to add more source parameters.
3.4. Influence of the source parameters
In this section, we highlight the influence of the source parameters on the predictions and
on the error. For a given geology, Figure 8a compares the predictions and the ground truth
for three different positions of the source (with the same orientation). One can firstly note
that the predicted wavefields are very similar to the ground truth for all source positions.
Especially, their spatial location closely follows the source position. This confirms that the
source position encoding in the source branch is accurate.
Figure 8a also illustrates the variability of surface wavefields that can be obtained by
moving the source in a heterogeneous geology. Indeed, the same geology was used for all
17

(a)

(b)

Figure 8: Comparison of the MIFNO predictions (lower rows) with the simulated ground
truth (upper rows) for a given geology and time. (a) the source position changes (indicated
by the white star) but the orientation remains constant. (b) the source position is fixed but
the orientation changes and is indicated with the (strike, dip, rake) angles.
three snapshots and the source orientation is fixed. Since seismic waves originating from
different source locations encounter different scatterers, they give rise to different surface
wavefields. This large variability on the outputs - only due to the source position - reiterates
the complexity of the task we aim at solving.
Next, we focus on the source orientation while fixing the source position. A geology with
low heterogeneities is chosen to emphasize the source orientation. Three sets of (strike, dip,
rake) angles are examined in Fig. 8b. Surface wavefields are depicted shortly after the first P
waves arrived at the surface of the domain. The wavefields phases are accurately predicted for
all orientations, meaning that the MIFNO can predict the influence of the source orientation
on ground motion. As already mentioned, a slight amplitude underestimation is visible in
some regions but this is not due to the source orientation.
For more systematic analyses, the 1-2 Hz frequency bias is evaluated on 1000 samples with
various geologies, source locations, and source orientations. Figure 9 shows the frequency
bias against the source coordinates. Similar errors are obtained for all source longitudes and
latitudes, meaning that the prediction accuracy is independent from the epicenter location.
There is a slightly positive correlation between the source depth and the frequency bias but
the inter-sample variability is of the same order. Figure 9 suggests that the underestimation of frequency content is greater when the source is deeper while errors are smaller and
overestimation is more frequent for shallow sources.
Since both the phase and envelope GOFs indicate better results for shallow sources (Fig.
S6), this effect is likely due to the increased complexity of the wavefields generated by long
propagation paths. Indeed, seismic waves originating from deep sources have encountered
18

Figure 9: For 1000 samples, the 1-2 Hz frequency bias is shown against the source position
(x, y, z). Negative (resp. positive) values indicate underestimation (resp. overestimation) of
the frequency content.
more heterogeneities on their path, which leads to diffraction and dispersion and hence,
perturbs the surface wavefields. Therefore, it is generally more complex to predict accurate
wavefields generated by deep sources.
Additionally, it can be observed that the source orientation parameters (strike, dip, and
rake angles) have no effect on the prediction accuracy (Fig. S5). This confirms that the
MIFNO produces equally accurate predictions for all types of sources.
4. Generalization ability
Neural networks and neural operators are not meant to extrapolate data beyond the training distribution. However, when evaluating predictions on real data, one cannot guarantee
that test data are perfectly in-distribution. Although predictions are not expected to be
excellent in this situation, it is crucial that they remain reasonable. For the elastic wave
equation, this especially means that predicted amplitudes should be of the right order of
magnitude and wave arrival times should be close to the reference.
4.1. Generalization to out-of-distribution sources
In the HEMEWS -3D database, the propagation domain extends from 0 km to 9.6 km and
the sources are located between 1.2 km and 8.4 km. However, since the source location is
provided as a vector of coordinates, the MIFNO is not constrained to sources located inside
the domain. Thus, in this section, we explore its ability to predict surface ground motion
originating from a source outside the training domain.
To simulate the reference ground motion, we create 1000 new geologies that are twice
larger than the original propagation domains and have the same depth. They are all het19

erogeneous geologies with parameters following the same distributions as the HEMEWS -3D
database (Tab. 1). In these large geologies, sources are located randomly within [−3.6km; 13.2km]
and their orientation is also randomly chosen. The reference ground motion is acquired only
at the surface of the original propagation domains, i.e. [0km; 9.6km].

Figure 10: 25-th percentile of envelope GOF (left) and phase GOF (right) for 1000 samples
where the source is located outside the training domain (dashed square) or even outside
the physical domain (dotted square). For reference, 1000 samples with a source inside the
training domain are shown.
Figure 10 shows that the MIFNO maintains very good predictions when the source is
located outside the training domain, both for the envelope GOF and the phase GOF. When
the source remains inside the propagation domain (dotted square in Fig. 10), the interquartile range is 6.24-7.70 for the envelope GOF and 7.41-8.77 for the phase GOF. These
good to excellent results are satisfying for out-of-distribution predictions since they are not
too far from the reference results on in-distribution data (Tab. 2). When the source locations
are farther from the training domain, predictions worsen. This can be seen in Fig. 10 for
sources out of the training domain and it is perfectly expected since neural operators are not
designed for severe extrapolation tasks.
4.2. Generalization to out-of-distribution geologies
To test the generalization ability of the MIFNO to out-of-distribution geologies, a 3D
overthrust model was adapted to the size of our geological domain (Aminzadeh et al., 1997).
This model is a 3D extension of the well-used Marmousi model. It shows a succession of thin
layers with contrasting velocities and several folds. It is downscaled to a spatial resolution
of 300 m to match the resolution of the HEMEWS -3D database (Fig. 11a). The source is
located at (1.2 km, 4.8 km, −9.0 km) with strike = 48°, dip = 45°, rake = 88°.
20

(a)

(b)

(c)
Figure 11: (a) Overthrust geology downscaled to 300 m. (b) Distribution of the envelope
and phase GOF for the HEMEWS -3D database (grey, darker colors indicate higher points
density) and for each surface sensor predicted with the overthrust geology (green). (c) EastWest component of the simulated (upper row) and predicted (middle row) velocity fields at
five time instants. The white star denotes the position of the source (depth=−9 km). The
error between simulation and prediction is given in the lower row.
21

Figure 11 shows that the predicted wavefronts are close to the simulations, in all parts of
the domain. In particular, the wave arrival times are accurately predicted and the influence
of the source orientation is well preserved since the phases correspond to the reference.
The amplitude of the main fluctuations is also accurate. The P wave peaks tend to be
overestimated (see t=2.50 s in Fig. 11c) but they have a small amplitude on the East-West
component. The focus is instead on the S waves, for which the amplitudes agree well with
the reference simulation (Fig. S8).
The envelope GOFs are good for a large majority of sensors and phase GOFs are very
good to excellent (Fig. 11b). The GOF distributions are concentrated around the mean
of the GOFs obtained on the HEMEWS -3D database, thereby showing the generalization
ability of the MIFNO to real complex geologies. Though Fig. 11b shows a significant GOF
variability between sensors for this out-of-distribution geology (around 2 GOF units), Fig.
S7 illustrates that GOFs below 6 are concentrated on small areas of the domain and GOFs
remain good or excellent on most of the surface. A similar variability was observed on the
HEMEW-3D database when geological fluctuations create complex wavefields patterns in
localized regions.
Finally, one can notice the absence of late fluctuations in the predictions (mainly visible
for low amplitudes around t=3 s). This was expected from our previous analyses since these
ground motion fluctuations are created by the multiple wave reflections and refractions on
the thin geological layers and they are difficult to predict.
4.3. Generalization to higher resolution
Although zero-shot super resolution can always be technically performed with FNOs,
FNOs are not invariant with respect to the resolution in the general framework (Bartolucci
et al., 2023). This means that high-resolution predictions may be less accurate than predictions at the training resolution. Since there is no theoretical result for FNOs including
source and PDE parameter, we investigate zero-shot super resolution experimentally with
the MIFNO. While the MIFNO was trained with inputs of spatial resolution of 32 × 32 × 32,
geologies are interpolated to 64 × 64 × 32 to obtain high-resolution predictions. The vertical
dimension is preserved to maintain the same depth-to-time conversion. Since the source is
given with absolute coordinates, there is no need to modify the source branch when modifying
the resolution.
Figure 12 shows that it is possible to obtain accurate velocity wavefields with a resolution
of 64 that has not been seen during training. The wavefronts are better defined with the
increased resolution, which allows to capture peaks more accurately in this example (see
snapshots at t=1.40 s in Fig. 12 for instance). However, some inaccuracies are visible at
higher resolution, especially on the boundaries. These artefacts can be explained by the fact
that high-resolution predictions are in advance at the edge of the domain, which induces a
phase difference between the prediction and the reference (Fig. S9).
5. Transfer learning on sources and geologies
When focusing on a region of interest, it is common to have prior knowledge of the local
geology and/or the type of sources that can generate earthquakes. Then, transfer learning is
22

Figure 12: East-West component of the velocity wavefield at five time instants. first row:
simulation with 32 × 32 sensors. second row: prediction with 32 × 32 sensors. third row:
simulation with 64 × 64 sensors. fourth row: prediction with 64 × 64 sensors. The white star
denotes the position of the source (depth=−1.3 km).

23

a well-used approach to improve the MIFNO accuracy for this specific setting. With transfer
learning, one designs a small database tailored to the region under study and the MIFNO
is fine-tuned on these data. Since one benefits from the knowledge acquired on the general
database, transfer learning involves limited simulation and training costs. Our case study
is chosen as the Le Teil earthquake (Mw4.9, France, 2019), the most severe earthquake in
metropolitan France in the last decade.
5.1. A database for the Le Teil earthquake
Based on a local 1D geological model, we designed a database of 4000 geologies tailored to
the Le Teil region. The 1D model contains six homogeneous horizontal layers (Smerzini et al.
(2023), Tab. S4). To create realistic variations of this geology, heterogeneities were added
as random fields inside each layer. Random fields follow the same parameter distributions as
the HEMEWS -3D database (Tab. 1).
Several studies estimated the source parameters of the Le Teil earthquake, both in the
form of a fault plane and an equivalent point-source. In our Le Teil database, we choose the
source locations close to the fault plane obtained by Vallage et al. (2021). The fault is 7 kmwide, 4 km-high and extends between −780 m and −4210 m. Following a latin hypercube
sampling, 4000 point sources were randomly placed along the fault plane, with a normal
distance to the fault plane up to 100 m to account for uncertainties in the fault localization
(Fig. 13).

Figure 13: Position of the 4000 sources in the Le Teil database, colored by their depth. The
red star denotes the source that generated the ground motion in Fig. 14
Each point source is assigned a random moment tensor, whose angles are chosen from the
moment tensor inversion conducted by Delouis et al. (2021): strike between 30° and 70°, dip
between 20° and 70°, rake between 70° and 120°. Similarly to the HEMEWS -3D database,
6.4 s of ground motion were generated at the 32 × 32 surface sensors.
24

Within this framework, we obtain 4000 samples (geology, source, ground motion wavefields) tailored to the Le Teil earthquake. Data are considered in-distribution since parameters
are within the range of the HEMEWS -3D database but vary in smaller intervals. Among the
4000 samples in the Le Teil database, up to 3000 were used for training, 300 for validation,
and 700 for testing.
5.2. Transfer learning predictions
Figure 14 illustrates the velocity time series obtained for a test sample in the Le Teil
database. Predictions are very close to the simulated ground truth for all wave arrivals
and amplitudes. One can especially notice the numerous high fluctuations that are very well
captured at all sensors. The MIFNO is also able to reproduce the late small-scale fluctuations
(between 3 s and 5 s, Fig. 14) thanks to the transfer learning. Phase GOFs are excellent or
close to excellent for all sensors, while envelope GOFs are excellent for the sensors with the
largest fluctuations (two bottom rows in Fig. 14) and good for the other sensors. These
metrics confirm the excellent visual agreement.

Figure 14: East-West velocity time series at 8 sensors aligned at x=2.25 km for a test sample.
Predictions (red dashed lines) were obtained with the MIFNO fine-tuned on 2000 samples.
The reference ground motion is given by the numerical simulation (black lines). For each
sensor, its position along the y axis is indicated, and the envelope GOF (EG) and phase GOF
(PG) are also reported.
Quantitatively, 700 predictions in the test dataset were assessed with the relative RMSE,
the frequency biases and the GOFs. When predicting ground motion directly with the generic
MIFNO (i.e. without transfer learning, line NTL =0 in Tab. 5), metrics are in line with the
general results on the HEMEWS -3D database (Tab. 2 and 3), although slightly better due to
the absence of deep sources in the Le Teil database. With only 100 transfer learning samples,
25

the GOFs already improve by 1 to 2 units, thereby illustrating the considerable benefits of
transfer learning, even with a limited number of data. After even a light transfer learning
(NTL =100), 68 % predictions reach a good envelope GOF and 61 % an excellent phase GOF.
# samples
Ntrain =3000
NTL =0
NTL =100
NTL =250
NTL =500
NTL =1000
NTL =2000
NTL =3000

Le Teil database with a random source along the fault plane
rRMSE
rFFTlow
rFFTmid
rFFThigh
EG
0.40 ; 0.73 -0.49 ; -0.02 -0.60 ; -0.06 -0.67 ; -0.09 6.60 ; 8.43
0.64 ; 0.98 -0.44 ; 0.33 -0.64 ; 0.06 -0.68 ; -0.05 5.98 ; 7.69
0.41 ; 0.78 -0.44 ; 0.08 -0.56 ; 0.00 -0.66 ; -0.05 6.51 ; 8.32
0.38 ; 0.75 -0.41 ; 0.09 -0.52 ; 0.03 -0.61 ; -0.01 6.70 ; 8.47
0.37 ; 0.74 -0.38 ; 0.11 -0.49 ; 0.06 -0.58 ; 0.02 6.87 ; 8.57
0.35 ; 0.69 -0.42 ; 0.03 -0.52 ; -0.02 -0.59 ; -0.04 6.92 ; 8.62
0.33 ; 0.68 -0.38 ; 0.05 -0.47 ; 0.01 -0.54 ; -0.01 7.10 ; 8.72
0.33 ; 0.68 -0.34 ; 0.08 -0.43 ; 0.04 -0.51 ; 0.02 7.20 ; 8.78

PG
8.25 ; 9.31
6.30 ; 8.44
8.17 ; 9.25
8.38 ; 9.35
8.51 ; 9.41
8.62 ; 9.46
8.72 ; 9.51
8.76 ; 9.53

Table 5: 1st and 3rd quartiles of the metrics computed on 700 test samples specific to the
Le Teil region. (upper row): training with only 3000 specific data. In other experiments,
transfer learning was used with 100 to 3000 samples (NTL = number of transfer learning
samples). rRMSE: relative RMSE (0 is best), rFFTlow : relative frequency bias 0-1Hz (0 is
best), rFFTmid : relative frequency bias 1-2Hz (0 is best), rFFThigh : relative frequency bias
2-5Hz (0 is best), EG: envelope Goodness-of-Fit (10 is best), PG: phase Goodness-of-Fit (10
is best). For frequency biases, negative values indicate underestimation.
For comparison purposes, the MIFNO was trained solely on 3000 samples from the Le Teil
database (line NTL =3000 in Tab. 5). However, the predictions accuracy was worse than the
predictions obtained with only 250 transfer learning samples. This shows the major benefits
of initializing the weights with the pre-trained MIFNO.
Table 5 also shows that the metrics continuously improve when the number of transfer
learning samples increases. The first quartile of frequency biases improves by 23 % between
NTL =100 and NTL =3000. The GOFs also benefit from larger transfer learning databases
and the improvement is mainly visible on the first quartile, meaning that good predictions
with NTL =100 tend towards excellent with NTL =3000 This is illustrated by comparing the
MIFNO predictions obtained with 2000 transfer learning samples in Fig. 14 and 500 samples
in Fig. S11. While the main fluctuations are already accurate with 500 transfer learning
samples, increasing the number of samples allows to better capture the late fluctuations with
a small amplitude.
6. Conclusion
We introduced a Multiple-Input Fourier Neural Operator (MIFNO) that takes as input
a 3D geological domain and a vector describing the source position and orientation. The
structured geology is processed with factorized Fourier layers while the source parameters
are transformed via convolutional layers while maintaining resolution invariance properties.
26

The MIFNO was trained on 30 000 earthquake simulations from the HEMEWS -3D database
covering a large variety of heterogeneous geological models, source positions and source orientations. It predicts 3-component surface ground motion between 0 s and 6.4 s for frequencies
up to 5 Hz.
The MIFNO performs on-par with the reference F-FNO model as was verified by restraining the MIFNO training task to a dataset with i) a fixed source and ii) a randomly
located source with a fixed orientation. This shows that the flexibility offered by our proposed
architecture preserves the accuracy of the F-FNO.
MIFNO predictions are considered as good to excellent for a vast majority of sensors,
following the common understanding of Goodness-Of-Fit (GOF) criteria. GOFs are better
for the phase than for the envelope, which indicates that the MIFNO is well suited to predict
wave arrival times and the spatial propagation of wavefronts. With 87 % of predictions having
a good envelope GOF, the main peaks are correctly predicted, which is of crucial importance
for seismological applications. Complex wave propagation phenomena due to heterogeneities
yield small-scale fluctuations with small amplitude that are difficult to predict accurately,
thereby hindering the envelope GOF.
These difficulties are exacerbated by the design choices of the HEMEWS -3D database
that purposely contains geologies with strong heterogeneities (mean coefficient of variation
of 20 %). However, such large coefficients of variations are rarely found in reality for large
correlation lengths. They are included in the HEMEWS -3D database to enhance its variability in a Scientific Machine Learning perspective. Therefore, predictions on common 1D
velocity models augmented by moderate heterogeneities will fall on the most accurate range
of the MIFNO predictions.
We found that the MIFNO tends to underestimate the frequency content of the ground
motion fluctuations. These fluctuations are created by the seismic wave reflections and
refractions on geological heterogeneities. They are stronger in the high-frequency components
of the signals and they are also more present when ground motion originates from deep
sources. This explains why we found that the frequency underestimation is more pronounced
in high-frequency components and for deep sources.
Using a more complex MIFNO (i.e. with more layers and more channels) is a privileged
approach to increase the accuracy, as illustrated by the difference between the 8-layer and 16layer MIFNO. Previous investigations on the F-FNO also showed that this architecture scales
well when the number of parameters increases (Lehmann et al., 2024a). We hypothesize that
similar results hold true for the MIFNO. As a consequence, provided that one can obtain
enough training data and bear the training costs of deeper models, the MIFNO will become
more accurate.
The MIFNO is also able to generalize well to different out-of-distribution data. The source
was located out of the training domain with only a moderate degradation of the accuracy.
Although it could also be placed outside the propagation domain, this large distribution
shift worsened the predictions. In addition, the MIFNO can be applied to geologies that
have a different resolution than the training resolution. Although there is no guarantee that
the accuracy will systematically be maintained at higher resolutions, the illustrated example
showed that finer predictions improve the predictions of peaks amplitudes. These results
27

show the robustness of the MIFNO when applied on test data, which is crucial to move
towards real-case applications.
Generalization to geologies that are far from the training database is challenging but
the MIFNO predicts accurate ground motion for an overthrust geology with thin folded
layers. There is a good visual agreement between the main predicted wavefronts and the
simulations, and the GOF distributions with the overthrust geology follow the distributions
on the HEMEWS -3D database. This illustrates the good generalization ability of the MIFNO
for real complex geologies. However, the thin layers in the overthrust geology create many
wave reflections, which are challenging to predict with a generic surrogate model.
When aiming for more accurate predictions in complex settings, transfer learning should
be used to specialize the MIFNO on a smaller database tailored to the region under study.
This approach was adopted for the Le Teil earthquake and it showed that only 250 transfer
learning samples lead to good accuracy. The fine-tuned MIFNO surpasses predictions of the
generic MIFNO and a MIFNO trained solely on the Le Teil database. When increasing the
number of transfer learning samples, predictions reach excellent accuracy and reproduce even
the small-amplitude fluctuations.
In conclusion, the MIFNO is the first surrogate model providing the flexibility of an
earthquake emulator while reducing significantly the computational costs. Once duly trained,
MIFNO predictions provide 6.4 s of ground motion in around 10 ms (with one GPU) while
numerical simulations take around 1 day (1 CPU equivalent). This massive speed-up paves
the way for 3D uncertainty quantification analysis, design optimization, and inverse problems
that are beyond reach with traditional methods.
We believe that the methodology presented in this work can be applied to other challenges related to propagation phenomena. Indeed, most wave Partial Differential Equations
(PDEs) involve a space-dependent parameter describing the material properties and source
parameters. Since both types of parameters are handled by the MIFNO, it can certainly
benefit several scientific communities.

28

Appendix A. Supplementary material
Appendix A.1. Supplementary material for prediction results

Figure S1: Evolution of the training loss (solid line) and validation loss (dashed line) as a
function of the number of epochs.
Table S1 compares the 8-layer MIFNO taking as input the 6 components of the moment
tensor (Mxx , Myy , Mzz , Mxy , Mxz , Myz ) or the equivalent representation with 3 angles (strike,
dip, rake).
Model
angle
moment

rRMSE
0.341 ; 0.589
0.338 ; 0.589

rFFTlow
-0.545 ; -0.095
-0.536 ; -0.091

rFFTmid
-0.63 ; -0.15
-0.64 ; -0.16

rFFThigh
-0.68 ; -0.18
-0.70 ; -0.20

EG
6.32 ; 7.89
6.29 ; 7.86

PG
8.07 ; 9.17
8.06 ; 9.16

Table S1: 1st and 3rd quartiles of the metrics computed on 1000 validation samples. rRMSE:
relative RMSE (0 is best), rFFTlow : relative frequency bias 0-1Hz (0 is best), rFFTmid :
relative frequency bias 1-2Hz (0 is best), rFFThigh : relative frequency bias 2-5Hz (0 is best),
EG: envelope Goodness-of-Fit (10 is best), PG: phase Goodness-of-Fit (10 is best). For
frequency biases, negative values indicate underestimation.

29

Figure S2: Distribution of the frequency bias for each sensor and each sample in the training
(grey area) and validation (blue line) dataset.

Figure S3: Intrinsic dimension estimated with a linear Principal Component Analysis (PCA,
left) and a non-linear Maximum Likelihood Estimator (MLE, right). For each method, the
intrinsic dimension is estimated on the HEMEW-3D database where the source is fixed and
the HEMEWS -3D database with a random source used to train the MIFNO

30

Appendix A.2. Supplementary material for comparison with baseline models
Table S2 compares a 16-layer F-FNO with a 16-layer MIFNO predicting surface velocity
wavefields when the source has a fixed position and orientation. It should be noted that the
MIFNO was not specifically trained on this database.
Model
F-FNO
MIFNO

Dataset with a fixed source position and fixed source orientation
rRMSE
rFFTlow
rFFTmid
rFFThigh
EG
PG
0.14 ; 0.25 -0.30 ; 0.03 -0.39 ; 0.01 -0.44 ; 0.01 7.09 ; 8.37 8.49 ; 9.32
0.20 ; 0.31 -0.40 ; -0.03 -0.51 ; -0.06 -0.56 ; -0.08 6.36 ; 7.65 7.71 ; 8.83

Table S2: 1st and 3rd quartiles of the metrics computed on 1000 validation samples. rRMSE:
relative RMSE (0 is best), rFFTlow : relative frequency bias 0-1Hz (0 is best), rFFTmid :
relative frequency bias 1-2Hz (0 is best), rFFThigh : relative frequency bias 2-5Hz (0 is best),
EG: envelope Goodness-of-Fit (10 is best), PG: phase Goodness-of-Fit (10 is best). For
frequency biases, negative values indicate underestimation.
Figure S4 illustrates the F-FNO and MIFNO predictions when the source has a fixed
position and orientation. Envelope GOFs of the F-FNO are between 8.3 and 8.7, MIFNO
ones are between 7.5 and 8.7. Phase GOFs of the F-FNO are between 9.2 and 9.6, MIFNO
ones between 8.2 and 9.4.
Dataset with a random source position and fixed source orientation
Model
rRMSE
rFFTlow
rFFTmid
rFFThigh
EG
F-FNO 8 layers 0.14 ; 0.24 -0.31 ; 0.01 -0.41 ; -0.03 -0.48 ; -0.04 6.71 ; 8.05
MIFNO 8 layers 0.13 ; 0.23 -0.27 ; 0.05 -0.37 ; -0.00 -0.43 ; -0.00 6.93 ; 8.24

PG
8.26 ; 9.19
8.40 ; 9.26

Table S3: 1st and 3rd quartiles of the metrics computed on 1000 validation samples. rRMSE:
relative RMSE (0 is best), rFFTlow : relative frequency bias 0-1Hz (0 is best), rFFTmid :
relative frequency bias 1-2Hz (0 is best), rFFThigh : relative frequency bias 2-5Hz (0 is best),
EG: envelope Goodness-of-Fit (10 is best), PG: phase Goodness-of-Fit (10 is best). For
frequency biases, negative values indicate underestimation. Both models were trained with
20 000 samples for 300 epochs.

31

Figure S4: East-West component of ground motion from simulations (black solid line), FFNO predictions (blue dashed line), and MIFNO predictions (red dashed line)

32

Appendix A.3. Supplementary material for influence of the source parameters

Figure S5: For 1000 samples, the 1-2 Hz frequency bias is shown against the source orientation
(strike, dip, rake).

Figure S6: For 1000 samples, the envelope and phase GOF of MIFNO predictions is shown
against the source depth.

33

Appendix A.4. Supplementary material for out-of-distribution data

Figure S7: Envelope and phase GOF for the geology depicted in Fig. 11. The white star
denotes the epicenter.

34

Figure S8: East-West component of ground motion from simulations (black solid line) and
MIFNO predictions (red dashed line) for the overthrust geology depicted in Fig. 11

35

Figure S9: East-West component of ground motion from simulations (black solid line) and
MIFNO predictions with resolution 64 (orange dashed line)

36

Appendix B. Supplementary material for transfer learning

Figure S10: VS distribution in
the Le Teil database. For each of
the 32 vertical levels, the mean
and percentiles are computed
over all horizontal points and
samples (shaded areas). Blue
lines show some individual vertical profiles.

Thickness (m)
600
600
300
600
5700
1800

VS (m/s)
2100
3500
1200
2300
3500
4500

VP (m/s)
3570
5950
2040
3910
5950
7650

ρ (kg/m3 )
2329
2706
1923
2380
2706
3170

Table S4: Reference 1D geological model for the LeTeil
region. Each layer from top to bottom is described by
its thickness, S-wave velocity (VS ), P-wave velocity (VP ),
and density ρ (adapted from Smerzini et al. (2023)).

37

Figure S11: Same as Figure 14 but only 500 transfer learning samples

38

Data availability statement
Code of the MIFNO and the HEMEWS -3D database will be released publicly upon acceptation of the manuscript.
Disclosure of interest
The authors have no conflict of interest to declare.

39

References
Allen, R.M., Melgar, D., 2019. Earthquake Early Warning: Advances, Scientific Challenges,
and Societal Needs. Annual Review of Earth and Planetary Sciences 47, 361–388. doi:10.
1146/annurev-earth-053018-060457.
Aminzadeh, F., Brac, J., Kunz, T., 1997. 3-D Salt and Overthrust Models. SEG/EAGE 3-D
Modeling Series No.1.
Baker, J.W., 2013. Probabilistic Seismic Hazard Analysis. Technical Report.
Bartolucci, F., de Bézenac, E., Raonić, B., Molinaro, R., Mishra, S., Alaifari, R., 2023.
Are Neural Operators Really Neural Operators? Frame Theory Meets Operator Learning.
URL: http://arxiv.org/abs/2305.19913, arXiv:2305.19913.
Basri, R., Galun, M., Geifman, A., Jacobs, D., Kasten, Y., Kritchman, S., 2020. Frequency
bias in neural networks for input of non-uniform density, in: Proceedings of the 37th
International Conference on Machine Learning, JMLR.org.
Bloemheuvel, S., Van Den Hoogen, J., Jozinović, D., Michelini, A., Atzmueller, M., 2023.
Graph neural networks for multivariate time series regression with application to seismic
data. International Journal of Data Science and Analytics 16, 317–332. doi:10.1007/
s41060-022-00349-6.
Bradley, B.A., Pettinga, D., Baker, J.W., Fraser, J., 2017. Guidance on the Utilization
of Earthquake-Induced Ground Motion Simulations in Engineering Practice. Earthquake
Spectra 33, 809–835. doi:10.1193/120216eqs219ep.
Brandstetter, J., Worrall, D., Welling, M., 2022. Message Passing Neural PDE Solvers, in:
International Conference on Learning Representations. URL: https://openreview.net/
forum?id=vSix3HPYKSU.
Cremen, G., Galasso, C., 2020. Earthquake early warning: Recent advances and perspectives.
Earth-Science Reviews 205, 103184. doi:10.1016/j.earscirev.2020.103184.
Datta, A., Wu, D.J., Zhu, W., Cai, M., Ellsworth, W.L., 2022. DeepShake: Shaking Intensity
Prediction Using Deep Spatiotemporal RNNs for Earthquake Early Warning. Seismological
Research Letters doi:10.1785/0220210141.
Delouis, B., Oral, E., Menager, M., Ampuero, J.P., Guilhem Trilla, A., Régnier, M., Deschamps, A., 2021. Constraining the point source parameters of the 11 November 2019
Mw 4.9 Le Teil earthquake using multiple relocation approaches, first motion and full
waveform inversions. Comptes Rendus. Géoscience 353, 1–24. doi:10.5802/crgeos.78.
Faccioli, E., Maggio, F., Paolucci, R., Quarteroni, A., 1997. 2d and 3D elastic wave propagation by a pseudo-spectral domain decomposition method. Journal of Seismology 1,
237–251. doi:10.1023/A:1009758820546.
40

Haghighat, E., Waheed, U.B., Karniadakis, G., 2024. En-DeepONet: An enrichment approach for enhancing the expressivity of neural operators with applications to seismology.
Computer Methods in Applied Mechanics and Engineering 420, 116681. doi:10.1016/j.
cma.2023.116681.
Hao, Z., Wang, Z., Su, H., Ying, C., Dong, Y., Liu, S., Cheng, Z., Song, J., Zhu, J.,
2023. GNOT: A general neural operator transformer for operator learning, in: Krause,
A., Brunskill, E., Cho, K., Engelhardt, B., Sabato, S., Scarlett, J. (Eds.), Proceedings of
the 40th International Conference on Machine Learning, PMLR. pp. 12556–12569. URL:
https://proceedings.mlr.press/v202/hao23c.html.
Hsu, T.Y., Huang, C.W., 2021. Onsite Early Prediction of PGA Using CNN With MultiScale and Multi-Domain P-Waves as Input. Frontiers in Earth Science 9, 626908. doi:10.
3389/feart.2021.626908.
Jiang, Z., Zhu, M., Li, D., Li, Q., Yuan, Y.O., Lu, L., 2023. Fourier-MIONet: Fourierenhanced multiple-input neural operators for multiphase modeling of geological carbon
sequestration. URL: http://arxiv.org/abs/2303.04778, arXiv:2303.04778.
Jin, P., Meng, S., Lu, L., 2022. MIONet: Learning multiple-input operators via tensor product. SIAM Journal on Scientific Computing 44, A3490–A3514. doi:10.1137/22M1477751.
Jozinović, D., Lomax, A., Štajduhar, I., Michelini, A., 2020. Rapid prediction of earthquake
ground shaking intensity using raw waveform data and a convolutional neural network.
Geophysical Journal International 222, 1379–1389. doi:10.1093/gji/ggaa233.
Komatitsch, D., Tromp, J., 1999. Introduction to the spectral element method for threedimensional seismic wave propagation. Geophysical Journal International 139, 806–822.
doi:10.1046/j.1365-246x.1999.00967.x.
Kong, Q., Rodgers, A., 2023. Feasibility of Using Fourier Neural Operators for 3D Elastic
Seismic Simulations. Technical Report LLNL-TR-854521. Lawrence Livermore National
Laboratory. URL: https://www.osti.gov/servlets/purl/2001189.
Kristeková, M., Kristek, J., Moczo, P., 2009. Time-frequency misfit and goodness-of-fit
criteria for quantitative comparison of time signals. Geophysical Journal International
178, 813–825. doi:10.1111/j.1365-246X.2009.04177.x.
Lehmann, F., Gatti, F., Bertin, M., Clouteau, D., 2023. Fourier Neural Operator Surrogate
Model to Predict 3D Seismic Waves Propagation, in: 5th ECCOMAS Thematic Conference
on Uncertainty Quantification in Computational Sciences and Engineering, Athens, Greece.
doi:10.7712/120223.10339.20362.
Lehmann, F., Gatti, F., Bertin, M., Clouteau, D., 2024a. 3D elastic wave propagation with
a Factorized Fourier Neural Operator (F-FNO). Computer Methods in Applied Mechanics
and Engineering 420, 116718. doi:10.1016/j.cma.2023.116718.
41

Lehmann, F., Gatti, F., Bertin, M., Clouteau, D., 2024b. Synthetic ground motions in
heterogeneous geologies: The HEMEW-3D dataset for scientific machine learning. Earth
System Science Data Discussions 2024, 1–26. doi:10.5194/essd-2023-470.
Levina, E., Bickel, P., 2004. Maximum likelihood estimation of intrinsic dimension, in: Saul,
L., Weiss, Y., Bottou, L. (Eds.), Advances in Neural Information Processing Systems,
MIT Press. URL: https://proceedings.neurips.cc/paper_files/paper/2004/file/
74934548253bcab8490ebd74afed7031-Paper.pdf.
Li, Z., Kovachki, N.B., Azizzadenesheli, K., liu, B., Bhattacharya, K., Stuart, A., Anandkumar, A., 2021. Fourier Neural Operator for Parametric Partial Differential Equations, in:
International Conference on Learning Representations. doi:10.48550/arXiv.2010.08895.
Lu, L., Jin, P., Pang, G., Zhang, Z., Karniadakis, G.E., 2021. Learning nonlinear operators
via DeepONet based on the universal approximation theorem of operators. Nature Machine
Intelligence 3, 218–229. doi:10.1038/s42256-021-00302-5.
Moczo, P., Kristek, J., Bard, P.Y., Stripajová, S., Hollender, F., Chovanová, Z., Kristeková,
M., Sicilia, D., 2018. Key structural parameters affecting earthquake ground motion in
2D and 3D sedimentary structures. Bulletin of Earthquake Engineering 16, 2421–2450.
doi:10.1007/s10518-018-0345-5.
Mousavi, S.M., Beroza, G.C., 2023.
Machine Learning in Earthquake Seismology. Annual Review of Earth and Planetary Sciences 51, 105–129. doi:10.1146/
annurev-earth-071822-100323.
O’Brien, G.S., Bean, C.J., Meiland, H., Witte, P., 2023. Imaging and seismic modelling inside volcanoes using machine learning. Scientific Reports 13, 630. doi:10.1038/
s41598-023-27738-6.
Rahaman, N., Baratin, A., Arpit, D., Draxler, F., Lin, M., Hamprecht, F., Bengio, Y.,
Courville, A., 2019. On the spectral bias of neural networks, in: Chaudhuri, K., Salakhutdinov, R. (Eds.), Proceedings of the 36th International Conference on Machine Learning,
PMLR. pp. 5301–5310. URL: https://proceedings.mlr.press/v97/rahaman19a.html.
Rahman, M.A., Ross, Z.E., Azizzadenesheli, K., 2023. U-NO: U-shaped Neural Operators.
Transactions on Machine Learning Research URL: https://openreview.net/forum?id=
j3oQF9coJd.
Smerzini, C., Paolucci, R., Stupazzini, M., 2011. Comparison of 3D, 2D and 1D numerical approaches to predict long period earthquake ground motion in the Gubbio
plain, Central Italy. Bulletin of Earthquake Engineering 9, 2007–2029. doi:10.1007/
s10518-011-9289-8.
Smerzini, C., Vanini, M., Paolucci, R., Renault, P., Traversa, P., 2023. Regional physicsbased simulation of ground motion within the Rhône Valley, France, during the Mw 4.9
42

2019 Le Teil earthquake. Bulletin of Earthquake Engineering 21, 1747–1774. doi:10.1007/
s10518-022-01591-w.
Ta, Q.A., Clouteau, D., Cottereau, R., 2010. Modeling of random anisotropic elastic media
and impact on wave propagation. European Journal of Computational Mechanics 19,
241–253. doi:10.3166/ejcm.19.241-253.
Touhami, S., Gatti, F., Lopez-Caballero, F., Cottereau, R., de Abreu Corrêa, L., Aubry,
L., Clouteau, D., 2022. SEM3D: A 3D High-Fidelity Numerical Earthquake Simulator for
Broadband (0–10 Hz) Seismic Response Prediction at a Regional Scale. Geosciences 12,
112. doi:10.3390/geosciences12030112.
Tran, A., Mathews, A., Xie, L., Ong, C.S., 2023. Factorized fourier neural operators,
in: The Eleventh International Conference on Learning Representations. URL: https:
//openreview.net/forum?id=tmIiMPl4IPa.
Vallage, A., Bollinger, L., Champenois, J., Duverger, C., Trilla, A.G., Hernandez, B., Pichon,
A.L., Listowski, C., Mazet-Roux, G., Menager, M., Pinel-Puysségur, B., Vergoz, J., 2021.
Multitechnology characterization of an unusual surface rupturing intraplate earthquake:
The M L 5.4 2019 Le Teil event in France. Geophysical Journal International 226, 803–
813. doi:10.1093/gji/ggab136.
Wang, A., Li, S., Lu, J., Zhang, H., Wang, B., Xie, Z., 2023. Prediction of PGA in earthquake early warning using a long short-term memory neural network. Geophysical Journal
International , ggad067doi:10.1093/gji/ggad067.
Yang, Y., Gao, A.F., Azizzadenesheli, K., Clayton, R.W., Ross, Z.E., 2023. Rapid Seismic
Waveform Modeling and Inversion with Neural Operators. IEEE Transactions on Geoscience and Remote Sensing , 1–1doi:10.1109/TGRS.2023.3264210.
Zhang, T., Trad, D., Innanen, K., 2023. Learning to solve the elastic wave equation with
Fourier Neural Operators. Geophysics , 1–63doi:10.1190/geo2022-0268.1.
Zhu, C., Riga, E., Pitilakis, K., Zhang, J., Thambiratnam, D., 2020. Seismic Aggravation in
Shallow Basins in Addition to One-dimensional Site Amplification. Journal of Earthquake
Engineering 24, 1477–1499. doi:10.1080/13632469.2018.1472679.
Zou, C., Azizzadenesheli, K., Ross, Z.E., Clayton, R.W., 2023. Deep Neural Helmholtz
Operators for 3D Elastic Wave Propagation and Inversion. URL: http://arxiv.org/
abs/2311.09608, arXiv:2311.09608.

43

